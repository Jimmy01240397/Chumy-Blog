<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta http-equiv=accept-ch content="DPR, Viewport-Width, Width"><link rel=icon href=/myfav.png type=image/gif><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" media=print onload="this.media='all'"><noscript><link href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel=stylesheet></noscript><link rel=stylesheet href=/css/font.css media=all><meta property="og:title" content="HITCON CTF 2021 Writeup"><meta property="og:description" content="hitconctf-2022-writeup 戰績 checker Disassemble checker.exe and checker_drv.sys using IDA Pro. We can know that the checker sends the 0x222080u code to the checker_drv driver to check if there is a &ldquo;hitcon&rdquo; at address 0x140003000.
checker.exe:
checker_drv.sys:
Also, there are other codes that can be sent that will use the data from addresses 0x140003030 to 0x14000312F to change the function at address 0x14001B30, and then use that function to calculate the hex data from addresses 0x140003000 to 0x14000302A."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.chummydns.com/blogs/hitconctf-2022-writeup/"><meta property="article:published_time" content="2022-11-28T00:00:00+08:00"><meta property="article:modified_time" content="2022-11-28T00:00:00+08:00"><meta property="og:site_name" content="Chumy's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="HITCON CTF 2021 Writeup"><meta name=twitter:description content="hitconctf-2022-writeup 戰績 checker Disassemble checker.exe and checker_drv.sys using IDA Pro. We can know that the checker sends the 0x222080u code to the checker_drv driver to check if there is a &ldquo;hitcon&rdquo; at address 0x140003000.
checker.exe:
checker_drv.sys:
Also, there are other codes that can be sent that will use the data from addresses 0x140003030 to 0x14000312F to change the function at address 0x14001B30, and then use that function to calculate the hex data from addresses 0x140003000 to 0x14000302A."><link rel=stylesheet href=/bootstrap-5/css/bootstrap.min.css media=all><link rel=stylesheet href=/css/header.css media=all><link rel=stylesheet href=/css/footer.css media=all><link rel=stylesheet href=/css/theme.css media=all><script type=text/javascript>(function(c,l,a,r,i,t,y){c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);})(window,document,"clarity","script","no4s0daf78");</script><style>:root{--text-color: #343a40;--text-secondary-color: #6c757d;--background-color: #eaedf0;--secondary-background-color: #64ffda1a;--primary-color: #007bff;--secondary-color: #f8f9fa;--text-color-dark: #e4e6eb;--text-secondary-color-dark: #b0b3b8;--background-color-dark: #18191a;--secondary-background-color-dark: #212529;--primary-color-dark: #ffffff;--secondary-color-dark: #212529}body{font-size:1rem;font-weight:400;line-height:1.5;text-align:left}html{background-color:var(--background-color)!important}body::-webkit-scrollbar{width:.5em;height:.5em;background-color:var(--background-color)}::-webkit-scrollbar-track{box-shadow:inset 0 0 6px var(--background-color);border-radius:1rem}::-webkit-scrollbar-thumb{border-radius:1rem;background-color:var(--secondary-color);outline:1px solid var(--background-color)}#search-content::-webkit-scrollbar{width:.5em;height:.1em;background-color:var(--background-color)}</style><meta name=description content><link rel=stylesheet href=/css/single.css><script defer src=/fontawesome-5/all-5.15.4.js></script><title>HITCON CTF 2021 Writeup | Chumy's Blog</title></head><body class=light><script>let localStorageValue=localStorage.getItem("pref-theme");let mediaQuery=window.matchMedia('(prefers-color-scheme: dark)').matches;switch(localStorageValue){case "dark":document.body.classList.add('dark');break;case "light":document.body.classList.remove('dark');break;default:if(mediaQuery){document.body.classList.add('dark');}
break;}</script><header><nav class="pt-3 navbar navbar-expand-lg animate"><div class="container-fluid mx-xs-2 mx-sm-5 mx-md-5 mx-lg-5"><a class="navbar-brand primary-font text-wrap" href=/><img src=/myfav.png width=30 height=30 class="d-inline-block align-top">
Chumy's Blog</a><div><input id=search autocomplete=off class="form-control mr-sm-2 d-none d-md-block" placeholder="Ctrl + k" aria-label=Search oninput=searchOnChange(event)></div><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarContent aria-controls=navbarContent aria-expanded=false aria-label="Toggle navigation"><svg aria-hidden="true" height="24" viewBox="0 0 16 16" width="24" data-view-component="true"><path fill-rule="evenodd" d="M1 2.75A.75.75.0 011.75 2h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 2.75zm0 5A.75.75.0 011.75 7h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 7.75zM1.75 12a.75.75.0 100 1.5h12.5a.75.75.0 100-1.5H1.75z"/></svg></button><div class="collapse navbar-collapse text-wrap primary-font" id=navbarContent><ul class="navbar-nav ms-auto text-center"><li class="nav-item navbar-text d-block d-md-none"><div class=nav-link><input id=search autocomplete=off class="form-control mr-sm-2" placeholder="Ctrl + k" aria-label=Search oninput=searchOnChange(event)></div></li><li class="nav-item navbar-text"><a class=nav-link href=/#about aria-label=about>About Me</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#experience aria-label=experience>Experience</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#education aria-label=education>Education</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#projects aria-label=projects>Projects</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#contact aria-label=contact>Contact</a></li><li class="nav-item navbar-text"><a class=nav-link href=/blogs title="Blog posts">Blog</a></li><li class="nav-item navbar-text"><a class=nav-link href=/gallery title="Blog posts">Gallery</a></li><li class="nav-item navbar-text"><a class=nav-link href=/cv.pdf title=CV>CV</a></li><li class="nav-item navbar-text"><div class=text-center><button id=theme-toggle><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></li></ul></div></div></nav></header><div id=content><section id=single><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-md-12 col-lg-9"><div class=pr-lg-4><div class="title mb-5"><h1 class="text-center mb-4">HITCON CTF 2021 Writeup</h1><div class=text-center>Chumy
<small>|</small>
Nov 28, 2022
<span id=readingTime>min read</span></div></div><div class=featured-image><img class=img-fluid src=/images/CTF.png alt="HITCON CTF 2021 Writeup"></div><article class="page-content p-2"><h1 id=hitconctf-2022-writeup>hitconctf-2022-writeup</h1><h2 id=戰績>戰績</h2><p><img src=https://user-images.githubusercontent.com/57281249/204162751-27c34090-7cab-418d-a0ec-0379f0e99436.png alt=image>
<img src=https://user-images.githubusercontent.com/57281249/204162537-eb1eceec-010c-4b65-b228-5b43ec9535bb.png alt=image></p><h2 id=checker>checker</h2><p><img src=https://user-images.githubusercontent.com/57281249/204158150-d012979f-8227-450d-a458-be0d2ffa67f9.png alt=image></p><p>Disassemble checker.exe and checker_drv.sys using IDA Pro. We can know that the checker sends the 0x222080u code to the checker_drv driver to check if there is a &ldquo;hitcon&rdquo; at address 0x140003000.</p><p>checker.exe:</p><p><img src=https://user-images.githubusercontent.com/57281249/204158308-726e9f4c-04f3-48de-b588-0a1f603af5a0.png alt=image></p><p>checker_drv.sys:</p><p><img src=https://user-images.githubusercontent.com/57281249/204158381-0616e107-20b6-4e4c-9fa7-6c7e6e5cf9fc.png alt=image></p><p>Also, there are other codes that can be sent that will use the data from addresses 0x140003030 to 0x14000312F to change the function at address 0x14001B30, and then use that function to calculate the hex data from addresses 0x140003000 to 0x14000302A.</p><p>checker_drv.sys:</p><p><img src=https://user-images.githubusercontent.com/57281249/204158683-35f275c5-6d17-46f9-9082-908e0bfef896.png alt=image>
<img src=https://user-images.githubusercontent.com/57281249/204158704-5374f7af-1d8c-4dd9-9c76-1aa5ef62d02c.png alt=image></p><p>When the driver is loaded, it will first use the data from address 0x140001430 to 0x14000144A to change the hexadecimal data at address 0x14001B30.</p><p>checker_drv.sys:</p><p><img src=https://user-images.githubusercontent.com/57281249/204158746-cdac8ff7-2d75-4ba7-8dcf-363da013e6b3.png alt=image></p><p>We need to send these codes in a specific order to get the correct flags.</p><p>We can find the order by choosing the code that makes the disassembly of function 0x14001B30 valid.</p><p>The order is 0x222070u,0x222020u,0x222060u,0x222000u,0x222010u,0x222040u,0x222030u,0x222050u</p><p>Then use the function we got to calculate the hex for addresses 0x140003000 to 0x14000302A and then we can get the flags.</p><h3 id=exploit>Exploit</h3><h4 id=exploit1>exploit1</h4><p>Use exploit1 to choose the order of codes.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=color:#f92672>import</span> sys

sourcedata3180 <span style=color:#f92672>=</span> bytes<span style=color:#f92672>.</span>fromhex(<span style=color:#e6db74>&#39;80E92280F1AD0FB6C16BC811B89E0000&#39;</span>)

data3188 <span style=color:#f92672>=</span> bytes<span style=color:#f92672>.</span>fromhex(<span style=color:#e6db74>&#39;40534883EC20488B053B0C0000488BDA488B4A104839087537488B4A08FF151D&#39;</span>)

data3178 <span style=color:#f92672>=</span> bytes<span style=color:#f92672>.</span>fromhex(<span style=color:#e6db74>&#39;19BC8F82D02C6134C09FF650D5FB0C6ED0EBE5E3CEB54CCA45AA11B23E626F7DD0EBA9E3B22F06477C28C5DEDE1A4ED6D82D934F826564FD08624B877E524730B7BAD039685350AB20D5CA8426716F911B364611A5F14E586C74D49C15E228D5D90F3D83F3FCD1131A621240AAEACDCBE1C6088198F66888BE23B59E55B9E27D5ADA3907F02E322059564CB48F3E0761D90F2D61F1913314CB4968FE1FD48AFEE1C618639A9B8A8A7F08C3E8E1EC0B8F3B0094A511E74766C49F981870F030F69471B195D1F06FB7D93D059EC15333769B4B69CADEFD7D67B8292BC7C5842CD18787F1989774AD4B32F04A5172EA09F738FD27BD1C527143959C1A86F2C0F9F8&#39;</span>)

data3180 <span style=color:#f92672>=</span> bytearray(sourcedata3180)

<span style=color:#66d9ef>for</span> a <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>32</span>):
    data3180[a<span style=color:#f92672>%</span><span style=color:#ae81ff>16</span>] <span style=color:#f92672>=</span> data3180[a<span style=color:#f92672>%</span><span style=color:#ae81ff>16</span>] <span style=color:#f92672>^</span> data3188[a]

sourcedata3180 <span style=color:#f92672>=</span> bytes(data3180)

<span style=color:#66d9ef>print</span>(f<span style=color:#e6db74>&#34;usage: {sys.argv[0]} &lt;index 0(0~7)&gt; &lt;index 1&gt;  &lt;index 2&gt; ...&#34;</span>)

order<span style=color:#f92672>=</span>[ int(a) <span style=color:#66d9ef>for</span> a <span style=color:#f92672>in</span> sys<span style=color:#f92672>.</span>argv[<span style=color:#ae81ff>1</span>:len(sys<span style=color:#f92672>.</span>argv)] ]

codes<span style=color:#f92672>=</span>list(range(<span style=color:#ae81ff>8</span>))

<span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>8</span>):
    <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;index &#34;</span> <span style=color:#f92672>+</span> str(i) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;: &#34;</span>)
    <span style=color:#66d9ef>if</span> i <span style=color:#f92672>&gt;=</span> len(order):
        <span style=color:#66d9ef>for</span> now <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>8</span>):
            data3180 <span style=color:#f92672>=</span> bytearray(sourcedata3180)
            <span style=color:#66d9ef>for</span> a <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>16</span>):
                data3180[a] <span style=color:#f92672>=</span> data3180[a] <span style=color:#f92672>^</span> data3178[now<span style=color:#f92672>*</span><span style=color:#ae81ff>0x20</span> <span style=color:#f92672>+</span> a]
            <span style=color:#66d9ef>print</span>(<span style=color:#e6db74>&#34;try &#34;</span> <span style=color:#f92672>+</span> str(now) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;: &#34;</span> <span style=color:#f92672>+</span> bytes(data3180)<span style=color:#f92672>.</span>hex())
        x <span style=color:#f92672>=</span> int(input(<span style=color:#e6db74>&#34;select code (0~7): &#34;</span>))
        <span style=color:#66d9ef>while</span> x <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>and</span> x <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>7</span>:
            x<span style=color:#f92672>=</span>int(input(<span style=color:#e6db74>&#34;select code (0~7): &#34;</span>))
        order<span style=color:#f92672>.</span>append(x)
    data3180 <span style=color:#f92672>=</span> bytearray(sourcedata3180)
    <span style=color:#66d9ef>for</span> a <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>16</span>):
        data3180[a] <span style=color:#f92672>=</span> data3180[a] <span style=color:#f92672>^</span> data3178[order[i]<span style=color:#f92672>*</span><span style=color:#ae81ff>0x20</span> <span style=color:#f92672>+</span> a]
    <span style=color:#66d9ef>print</span>(str(order[i]) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;: &#34;</span> <span style=color:#f92672>+</span> bytes(data3180)<span style=color:#f92672>.</span>hex())
    <span style=color:#66d9ef>for</span> a <span style=color:#f92672>in</span> range(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>16</span>):
        data3180[a] <span style=color:#f92672>=</span> data3180[a] <span style=color:#f92672>^</span> data3178[order[i]<span style=color:#f92672>*</span><span style=color:#ae81ff>0x20</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>0x10</span> <span style=color:#f92672>+</span> a]
    sourcedata3180 <span style=color:#f92672>=</span> bytes(data3180)
</code></pre></div><h4 id=exploit2>exploit2</h4><p>Use exploit2 for get flag.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=color:#75715e>#include</span><span style=color:#75715e>&lt;stdio.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e>#include</span><span style=color:#75715e>&lt;string.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e></span>
<span style=color:#75715e>#define _BYTE unsigned char
</span><span style=color:#75715e>#define __int64 long long
</span><span style=color:#75715e>#define __int8 char
</span><span style=color:#75715e></span>
<span style=color:#66d9ef>typedef</span> <span style=color:#a6e22e>__int64</span> (<span style=color:#f92672>*</span>func)(<span style=color:#66d9ef>int</span>);

<span style=color:#66d9ef>__int64</span> <span style=color:#a6e22e>func0</span>(<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>__int8</span> a1)
{
  <span style=color:#66d9ef>__int64</span> result; <span style=color:#75715e>// rax
</span><span style=color:#75715e></span>
  result <span style=color:#f92672>=</span> (<span style=color:#ae81ff>8</span> <span style=color:#f92672>*</span> a1) <span style=color:#f92672>|</span> (a1 <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>5</span>);
  <span style=color:#66d9ef>return</span> result;
}

<span style=color:#66d9ef>__int64</span> <span style=color:#a6e22e>func1</span>(<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>__int8</span> a1)
{
  <span style=color:#66d9ef>return</span> a1 <span style=color:#f92672>^</span> <span style=color:#ae81ff>0x26u</span>;
}

<span style=color:#66d9ef>__int64</span> <span style=color:#a6e22e>func2</span>(<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>__int8</span> a1)
{
  <span style=color:#66d9ef>__int64</span> result; <span style=color:#75715e>// rax
</span><span style=color:#75715e></span>
  result <span style=color:#f92672>=</span> (<span style=color:#ae81ff>16</span> <span style=color:#f92672>*</span> a1) <span style=color:#f92672>|</span> (a1 <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>4</span>);
  <span style=color:#66d9ef>return</span> result;
}

<span style=color:#66d9ef>__int64</span> <span style=color:#a6e22e>func3</span>(<span style=color:#66d9ef>int</span> a1)
{
  <span style=color:#66d9ef>return</span> (<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span>)(a1 <span style=color:#f92672>+</span> <span style=color:#ae81ff>55</span>);
}

<span style=color:#66d9ef>__int64</span> <span style=color:#a6e22e>func4</span>(<span style=color:#66d9ef>int</span> a1)
{
  <span style=color:#66d9ef>return</span> (<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span>)(a1 <span style=color:#f92672>+</span> <span style=color:#ae81ff>123</span>);
}

<span style=color:#66d9ef>__int64</span> <span style=color:#a6e22e>func5</span>(<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>__int8</span> a1)
{
  <span style=color:#66d9ef>__int64</span> result; <span style=color:#75715e>// rax
</span><span style=color:#75715e></span>
  result <span style=color:#f92672>=</span> (a1 <span style=color:#f92672>&lt;&lt;</span> <span style=color:#ae81ff>7</span>) <span style=color:#f92672>|</span> (a1 <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>1</span>);
  <span style=color:#66d9ef>return</span> result;
}

<span style=color:#66d9ef>__int64</span> <span style=color:#a6e22e>func6</span>(<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>__int8</span> a1)
{
  <span style=color:#66d9ef>return</span> <span style=color:#ae81ff>173</span> <span style=color:#f92672>*</span> (<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>int</span>)a1;
}

<span style=color:#66d9ef>__int64</span> <span style=color:#a6e22e>func7</span>(<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>__int8</span> a1)
{
  <span style=color:#66d9ef>__int64</span> result; <span style=color:#75715e>// rax
</span><span style=color:#75715e></span>
  result <span style=color:#f92672>=</span> (<span style=color:#ae81ff>4</span> <span style=color:#f92672>*</span> a1) <span style=color:#f92672>|</span> (a1 <span style=color:#f92672>&gt;&gt;</span> <span style=color:#ae81ff>6</span>);
  <span style=color:#66d9ef>return</span> result;
}

<span style=color:#66d9ef>int</span> <span style=color:#a6e22e>main</span>()
{
    <span style=color:#66d9ef>char</span> <span style=color:#f92672>*</span>defaultdatahex <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;6360A5B9FFFC300A48BBFEFE322C0AD6E6FEFE322C0AD6BB4A4A322CFCFF0AFDBBFE2CB963D6B962D60A4F&#34;</span>;
    <span style=color:#66d9ef>char</span> datahex[<span style=color:#ae81ff>1000</span>] <span style=color:#f92672>=</span> {<span style=color:#ae81ff>0</span>}, data[<span style=color:#ae81ff>50</span>] <span style=color:#f92672>=</span> {<span style=color:#ae81ff>0</span>};

    <span style=color:#66d9ef>if</span>(defaultdatahex) strcpy(datahex, defaultdatahex);
    <span style=color:#66d9ef>else</span> gets(datahex);
    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>, count <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; datahex[i]; count<span style=color:#f92672>++</span>)
    {
        <span style=color:#66d9ef>char</span> now[<span style=color:#ae81ff>3</span>] <span style=color:#f92672>=</span> {<span style=color:#ae81ff>0</span>};
        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> k <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; k <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>2</span>; k<span style=color:#f92672>++</span>, i<span style=color:#f92672>++</span>)
        {
            <span style=color:#66d9ef>if</span>((datahex[i] <span style=color:#f92672>&gt;=</span> <span style=color:#e6db74>&#39;A&#39;</span> <span style=color:#f92672>&amp;&amp;</span> datahex[i] <span style=color:#f92672>&lt;=</span> <span style=color:#e6db74>&#39;F&#39;</span>) <span style=color:#f92672>||</span> (datahex[i] <span style=color:#f92672>&gt;=</span> <span style=color:#e6db74>&#39;a&#39;</span> <span style=color:#f92672>&amp;&amp;</span> datahex[i] <span style=color:#f92672>&lt;=</span> <span style=color:#e6db74>&#39;f&#39;</span>) <span style=color:#f92672>||</span> (datahex[i] <span style=color:#f92672>&gt;=</span> <span style=color:#e6db74>&#39;0&#39;</span> <span style=color:#f92672>&amp;&amp;</span> datahex[i] <span style=color:#f92672>&lt;=</span> <span style=color:#e6db74>&#39;9&#39;</span>))
            {
                now[k] <span style=color:#f92672>=</span> datahex[i];
            }
            <span style=color:#66d9ef>else</span>
            {
                k<span style=color:#f92672>--</span>;
            }
        }
        sscanf(now, <span style=color:#e6db74>&#34;%x&#34;</span>, <span style=color:#f92672>&amp;</span>data[count]);
    }

    func allfunc[<span style=color:#ae81ff>8</span>] <span style=color:#f92672>=</span> {func0,func1,func2,func3,func4,func5,func6,func7};

    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>8</span>; i<span style=color:#f92672>++</span>)
    {
        <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> k <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; k <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>43</span>; k<span style=color:#f92672>++</span>)
        {
            data[k] <span style=color:#f92672>=</span> allfunc[i](data[k]);
        }
    }

    printf(<span style=color:#e6db74>&#34;hex: &#34;</span>);
    <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>; i <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>43</span>; i<span style=color:#f92672>++</span>)
    {
        printf(<span style=color:#e6db74>&#34;%02x &#34;</span>, (<span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>char</span>)data[i]);
    }
    printf(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>);
    printf(<span style=color:#e6db74>&#34;%s</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>, data);
}
</code></pre></div><h3 id=flag>Flag</h3><p><code>hitcon{r3ally_re4lly_rea11y_normal_checker}</code></p><h2 id=other>other</h2><ul><li><a href=https://hackmd.io/@Vincent550102/ByMH8--Do>other</a></li></ul></article></div></div><div class="col-sm-12 col-md-12 col-lg-3"><div class=sticky-sidebar><aside class=toc><h5>Table Of Contents</h5><div class=toc-content><nav id=TableOfContents><ul><li><a href=#戰績>戰績</a></li><li><a href=#checker>checker</a><ul><li><a href=#exploit>Exploit</a></li><li><a href=#flag>Flag</a></li></ul></li><li><a href=#other>other</a></li></ul></nav></div></aside><aside class=tags><h5>Tags</h5><ul class="tags-ul list-unstyled list-inline"><li class=list-inline-item><a href=https://blog.chummydns.com/tags/ctf target=_blank>CTF</a></li></ul></aside><aside class=social><h5>Social</h5><div class=social-content><ul class=list-inline><li class="list-inline-item text-center"><a target=_blank href="https://twitter.com/share?text=HITCON%20CTF%202021%20Writeup&url=https%3a%2f%2fblog.chummydns.com%2fblogs%2fhitconctf-2022-writeup%2f"><i class="fab fa-twitter"></i></a></li><li class="list-inline-item text-center"><a target=_blank href="https://api.whatsapp.com/send?text=HITCON%20CTF%202021%20Writeup: https%3a%2f%2fblog.chummydns.com%2fblogs%2fhitconctf-2022-writeup%2f"><i class="fab fa-whatsapp"></i></a></li><li class="list-inline-item text-center"><a target=_blank href="mailto:?subject=HITCON%20CTF%202021%20Writeup&body=Check%20out%20this%20site https%3a%2f%2fblog.chummydns.com%2fblogs%2fhitconctf-2022-writeup%2f"><i class="fa fa-envelope"></i></a></li></ul></div></aside></div></div></div><div class=row><div class="col-sm-12 col-md-12 col-lg-9 p-4"></div></div></div><button class="p-2 px-3" onclick=topFunction() id=topScroll>
<i class="fas fa-angle-up"></i></button></section><div class=progress><div id=scroll-progress-bar class=progress-bar role=progressbar aria-valuenow=0 aria-valuemin=0 aria-valuemax=100></div></div><script src=/js/scrollProgressBar.js></script><script>var topScroll=document.getElementById("topScroll");window.onscroll=function(){scrollFunction()};function scrollFunction(){if(document.body.scrollTop>20||document.documentElement.scrollTop>20){topScroll.style.display="block";}else{topScroll.style.display="none";}}
function topFunction(){document.body.scrollTop=0;document.documentElement.scrollTop=0;}</script><script src=/js/readingTime.js></script></div><footer><div class="container py-3" id=recent-posts><div class="h3 text-center text-secondary py-3">Recent Posts</div><div class="row justify-content-center"><div class="col-lg-4 col-md-6 pt-2"><div class="card h-100"><div class=card-header><a href=/blogs/hitconctf-2024-writeup/><img src=/images/CTF.png class=card-img-top alt="HITCON CTF 2024 Writeup"></a></div><div class="card-body bg-transparent p-3 shadow-sm"><a href=/blogs/hitconctf-2024-writeup/ class="primary-font card-title"><h5 class="card-title bg-transparent" title="HITCON CTF 2024 Writeup">HITCON CTF 2024 Writeup</h5></a><div class="card-text secondary-font"><p>hitconctf-2024-writeup 這場與 星爆吉娃娃、BambooFox、以及我們 B33f 50UP 所組成的 星爆牛炒竹狐 隊伍一起打到了世界第 24 名、台灣排名第一名，並且打進今年 HITCON CTF 決賽。
這邊就來寫一下我解的題目 writeup。
戰績 Flag Reader 目標是上傳一個帶有 flag.txt -> /flag.txt 的 symlink，但是 server 的 python 會用 tarfile 做一次 tarinfo 的檢查，檢查一定要是 file 且名字不能帶 flag.txt，檢查過才會用 subprocess 跑 busybox …</p></div></div><div class="mt-auto card-footer"><span class=float-start>Jul 16, 2024</span>
<a href=/blogs/hitconctf-2024-writeup/ class="float-end btn btn-outline-info btn-sm">Read</a></div></div></div><div class="col-lg-4 col-md-6 pt-2"><div class="card h-100"><div class="card-body bg-transparent p-3 shadow-sm"><a href=/blogs/openssl_usage/ class="primary-font card-title"><h5 class="card-title bg-transparent" title="OpenSSL 簽憑證教學">OpenSSL 簽憑證教學</h5></a><div class="card-text secondary-font"><p>OpenSSL Generate a private key openssl genrsa -out &lt;private key file> &lt;key length general we used 2048> 執行結果 key 的內容 Generate a certificate request openssl req -new -key &lt;private file> -out &lt;request file> -addext 'subjectAltName=&lt;Alternative Name>' #addext is …</p></div></div><div class="mt-auto card-footer"><span class=float-start>Jul 10, 2024</span>
<a href=/blogs/openssl_usage/ class="float-end btn btn-outline-info btn-sm">Read</a></div></div></div><div class="col-lg-4 col-md-6 pt-2"><div class="card h-100"><div class="card-body bg-transparent p-3 shadow-sm"><a href=/blogs/simple-vpn-generate/ class="primary-font card-title"><h5 class="card-title bg-transparent" title="各常見 VPN 架設簡易教學">各常見 VPN 架設簡易教學</h5></a><div class="card-text secondary-font"><p>IPsec Install strongswan apt install strongswan strongswan-pki libcharon-extra-plugins libcharon-extauth-plugins libstrongswan-extra-plugins Config file /etc/ipsec.conf for connect config /etc/ipsec.secrets A config to save your password, preshare key, private key /etc/ipsec.d/ The …</p></div></div><div class="mt-auto card-footer"><span class=float-start>Jul 10, 2024</span>
<a href=/blogs/simple-vpn-generate/ class="float-end btn btn-outline-info btn-sm">Read</a></div></div></div></div></div><div class="text-center pt-2"><span class=px-1><a href=https://github.com/Jimmy01240397 aria-label=github><svg xmlns="http://www.w3.org/2000/svg" width="2.7em" height="2.7em" viewBox="0 0 1792 1792"><path d="M522 1352q-8 9-20-3-13-11-4-19 8-9 20 3 12 11 4 19zm-42-61q9 12 0 19-8 6-17-7t0-18q9-7 17 6zm-61-60q-5 7-13 2-10-5-7-12 3-5 13-2 10 5 7 12zm31 34q-6 7-16-3-9-11-2-16 6-6 16 3 9 11 2 16zm129 112q-4 12-19 6-17-4-13-15t19-7q16 5 13 16zm63 5-16 11q-17 2-17-11l16-11q17-2 17 11zm58-10q2 10-14 14t-18-8 14-15q16-2 18 9zm964-956v960q0 119-84.5 203.5T1376 1664h-224q-16 0-24.5-1t-19.5-5-16-14.5-5-27.5v-239q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105T1386 856q0-121-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27T578 459.5 492 446q-44 113-7 204-79 85-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-40 36-49 103-21 10-45 15t-57 5-65.5-21.5T484 1274q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 .5 103t.5 68q0 22-11 33.5t-22 13-33 1.5H416q-119 0-203.5-84.5T128 1376V416q0-119 84.5-203.5T416 128h960q119 0 203.5 84.5T1664 416z"/></svg></a></span><span class=px-1><a href=https://www.linkedin.com/in/%E8%81%BF%E5%96%84-%E8%94%A1-9b01b4254/ aria-label=linkedin><svg xmlns="http://www.w3.org/2000/svg" width="2.4em" height="2.4em" fill="#fff" aria-label="LinkedIn" viewBox="0 0 512 512"><rect width="512" height="512" fill="#0077b5" rx="15%"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg></a></span><a href=https://twitter.com/jimmy01240397 aria-label=twitter><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="48" height="48"><path fill="#03a9f4" d="M42 37c0 2.762-2.239 5-5 5H11c-2.762.0-5-2.238-5-5V11c0-2.762 2.238-5 5-5h26c2.761.0 5 2.238 5 5V37z"/><path fill="#fff" d="M36 17.12c-.882.391-1.999.758-3 .88 1.018-.604 2.633-1.862 3-3-.951.559-2.671 1.156-3.793 1.372C31.311 15.422 30.033 15 28.617 15 25.897 15 24 17.305 24 20v2c-4 0-7.9-3.047-10.327-6-.427.721-.667 1.565-.667 2.457.0 1.819 1.671 3.665 2.994 4.543-.807-.025-2.335-.641-3-1 0 .016.0.036.0.057.0 2.367 1.661 3.974 3.912 4.422C16.501 26.592 16 27 14.072 27c.626 1.935 3.773 2.958 5.928 3-1.686 1.307-4.692 2-7 2-.399.0-.615.022-1-.023C14.178 33.357 17.22 34 20 34c9.057.0 14-6.918 14-13.37.0-.212-.007-.922-.018-1.13C34.95 18.818 35.342 18.104 36 17.12"/></svg></a><a href=https://www.instagram.com/rm_rf_chumy/ aria-label=instagram><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="48" height="48"><radialGradient id="yOrnnhliCrdS2gy~4tD8ma" cx="19.38" cy="42.035" r="44.899" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#fd5"/><stop offset=".328" stop-color="#ff543f"/><stop offset=".348" stop-color="#fc5245"/><stop offset=".504" stop-color="#e64771"/><stop offset=".643" stop-color="#d53e91"/><stop offset=".761" stop-color="#cc39a4"/><stop offset=".841" stop-color="#c837ab"/></radialGradient><path fill="url(#yOrnnhliCrdS2gy~4tD8ma)" d="M34.017 41.99l-20 .019c-4.4.004-8.003-3.592-8.008-7.992l-.019-20c-.004-4.4 3.592-8.003 7.992-8.008l20-.019c4.4-.004 8.003 3.592 8.008 7.992l.019 20C42.014 38.383 38.417 41.986 34.017 41.99z"/><radialGradient id="yOrnnhliCrdS2gy~4tD8mb" cx="11.786" cy="5.54" r="29.813" gradientTransform="matrix(1 0 0 .6663 0 1.849)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#4168c9"/><stop offset=".999" stop-color="#4168c9" stop-opacity="0"/></radialGradient><path fill="url(#yOrnnhliCrdS2gy~4tD8mb)" d="M34.017 41.99l-20 .019c-4.4.004-8.003-3.592-8.008-7.992l-.019-20c-.004-4.4 3.592-8.003 7.992-8.008l20-.019c4.4-.004 8.003 3.592 8.008 7.992l.019 20C42.014 38.383 38.417 41.986 34.017 41.99z"/><path fill="#fff" d="M24 31c-3.859.0-7-3.14-7-7s3.141-7 7-7 7 3.14 7 7S27.859 31 24 31zm0-12c-2.757.0-5 2.243-5 5s2.243 5 5 5 5-2.243 5-5S26.757 19 24 19z"/><circle cx="31.5" cy="16.5" r="1.5" fill="#fff"/><path fill="#fff" d="M30 37H18c-3.859.0-7-3.14-7-7V18c0-3.86 3.141-7 7-7h12c3.859.0 7 3.14 7 7v12C37 33.86 33.859 37 30 37zM18 13c-2.757.0-5 2.243-5 5v12c0 2.757 2.243 5 5 5h12c2.757.0 5-2.243 5-5V18c0-2.757-2.243-5-5-5H18z"/></svg></a><a href="https://www.facebook.com/profile.php?id=100005111161079" aria-label=facebook><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="48" height="48"><path fill="#3f51b5" d="M42 37c0 2.762-2.238 5-5 5H11c-2.761.0-5-2.238-5-5V11c0-2.762 2.239-5 5-5h26c2.762.0 5 2.238 5 5V37z"/><path fill="#fff" d="M34.368 25H31v13h-5V25h-3v-4h3v-2.41c.002-3.508 1.459-5.59 5.592-5.59H35v4h-2.287C31.104 17 31 17.6 31 18.723V21h4L34.368 25z"/></svg></a></div><div class="container py-4"><div class="row justify-content-center"><div class="col-md-4 text-center"><div class=pb-2><a href=https://blog.chummydns.com title="Chumy's Blog"><img alt="Footer logo" src=/myfav.png height=40px width=40px></a></div>&copy; 2024 All rights reserved<div class=text-secondary>Made with
<span class=text-danger>&#10084;</span>
and
<a href=https://github.com/gurusabarish/hugo-profile target=_blank title="Designed and developed by gurusabarish">Hugo Profile</a></div></div></div></div></footer><script src=/bootstrap-5/js/bootstrap.bundle.min.js></script><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia&&window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})
var tooltipTriggerList=[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
var tooltipList=tooltipTriggerList.map(function(tooltipTriggerEl){return new bootstrap.Tooltip(tooltipTriggerEl)})</script><script src=/js/search.js></script><section id=search-content class=py-2><div class=container id=search-results></div></section></body></html>