<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta http-equiv=Accept-CH content="DPR, Viewport-Width, Width"><link rel=icon href=/myfav.png type=image/gif><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" media=print onload='this.media="all"'><noscript><link href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel=stylesheet></noscript><link rel=stylesheet href=/css/font.css media=all><meta property="og:url" content="https://blog.chummydns.com/blogs/tscctf-2024-official-writeup/"><meta property="og:site_name" content="Chumy's Blog"><meta property="og:title" content="TSCCTF 2024 Official WriteUp"><meta property="og:description" content="TSCCTF 2024 Official WriteUp 這次與 TSC 的夥伴們一起舉辦了一場 CTF 比賽，而我則負責 infra 的建置以及出一題 reverse 題目，雖說我似乎難度沒有控好，還在學習控難度中。
Just Shooting Game 基本上這題最大的難點有兩個：
取得 magic 值 通靈出 Transfer.exec 是某種 bytecode interpreter ，然後把解出來的 code 丟 IDA 之類的解析。 解題 這題 code 用 ILSpy 逆會比較完整，但是這邊 writeup 還是用 Dnspy 寫。
DnSpy 打開 ShootingGame_Data\Managed\Assembly-CSharp.dll 會發現有一些 Class 有一個叫 code 的 string variable 裡面塞了一坨奇怪的東西，decode 以後會發現這些都 emoji。
這些 code 會在該 Class 裡和一個叫 magic 的變數做 Transfer.etob 運算以後，跟一些參數一起跑 Transfer.exec
通過與 gun、enemy 等等 Class 比對後，發現 GameManager 是送入一個字串 Call Transfer.exec 以後會依據 Call 完後所得到的 value variable 轉成 Boolean 並判斷如果為 True 就把 supermode 設為 True，觀察 gun class 會發現 supermode 會讓玩家進入無敵狀態並沒有攻擊速度限制，應該是一個打入作弊代碼會開啟作弊模式的東西。其他 Call Transfer.exec 的地方都是在做字串比對，可以判斷 Transfer.exec 會依據 code 跟 magic 運算後的 byte array 做相應的事情，但是 Transfer.exec 到底做了甚麼還不清楚，同時因為只有 GameManager 不是字串比對，所以目標可能在這裡，猜測那個作弊代碼可能就是 flag。"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="blogs"><meta property="article:published_time" content="2024-01-05T00:00:00+08:00"><meta property="article:modified_time" content="2024-01-05T00:00:00+08:00"><meta property="article:tag" content="CTF"><meta name=twitter:card content="summary"><meta name=twitter:title content="TSCCTF 2024 Official WriteUp"><meta name=twitter:description content="TSCCTF 2024 Official WriteUp 這次與 TSC 的夥伴們一起舉辦了一場 CTF 比賽，而我則負責 infra 的建置以及出一題 reverse 題目，雖說我似乎難度沒有控好，還在學習控難度中。
Just Shooting Game 基本上這題最大的難點有兩個：
取得 magic 值 通靈出 Transfer.exec 是某種 bytecode interpreter ，然後把解出來的 code 丟 IDA 之類的解析。 解題 這題 code 用 ILSpy 逆會比較完整，但是這邊 writeup 還是用 Dnspy 寫。
DnSpy 打開 ShootingGame_Data\Managed\Assembly-CSharp.dll 會發現有一些 Class 有一個叫 code 的 string variable 裡面塞了一坨奇怪的東西，decode 以後會發現這些都 emoji。
這些 code 會在該 Class 裡和一個叫 magic 的變數做 Transfer.etob 運算以後，跟一些參數一起跑 Transfer.exec
通過與 gun、enemy 等等 Class 比對後，發現 GameManager 是送入一個字串 Call Transfer.exec 以後會依據 Call 完後所得到的 value variable 轉成 Boolean 並判斷如果為 True 就把 supermode 設為 True，觀察 gun class 會發現 supermode 會讓玩家進入無敵狀態並沒有攻擊速度限制，應該是一個打入作弊代碼會開啟作弊模式的東西。其他 Call Transfer.exec 的地方都是在做字串比對，可以判斷 Transfer.exec 會依據 code 跟 magic 運算後的 byte array 做相應的事情，但是 Transfer.exec 到底做了甚麼還不清楚，同時因為只有 GameManager 不是字串比對，所以目標可能在這裡，猜測那個作弊代碼可能就是 flag。"><link rel=stylesheet href=/bootstrap-5/css/bootstrap.min.css media=all><link rel=stylesheet href=/css/header.css media=all><link rel=stylesheet href=/css/footer.css media=all><link rel=stylesheet href=/css/theme.css media=all><style>:root{--text-color:#343a40;--text-secondary-color:#6c757d;--text-link-color:#007bff;--background-color:#eaedf0;--secondary-background-color:#64ffda1a;--primary-color:#007bff;--secondary-color:#f8f9fa;--text-color-dark:#e4e6eb;--text-secondary-color-dark:#b0b3b8;--text-link-color-dark:#ffffff;--background-color-dark:#18191a;--secondary-background-color-dark:#212529;--primary-color-dark:#ffffff;--secondary-color-dark:#212529}body{font-size:1rem;font-weight:400;line-height:1.5;text-align:left}html{background-color:var(--background-color)!important}body::-webkit-scrollbar{height:0;width:8px;background-color:var(--background-color)}::-webkit-scrollbar-track{border-radius:1rem}::-webkit-scrollbar-thumb{border-radius:1rem;background:#b0b0b0;outline:1px solid var(--background-color)}#search-content::-webkit-scrollbar{width:.5em;height:.1em;background-color:var(--background-color)}</style><meta name=description content><link rel=stylesheet href=/css/single.css><script defer src=/fontawesome-6/all-6.4.2.js></script><title>TSCCTF 2024 Official WriteUp | Chumy's Blog</title></head><body class=light><script>let localStorageValue=localStorage.getItem("pref-theme"),mediaQuery=window.matchMedia("(prefers-color-scheme: dark)").matches;switch(localStorageValue){case"dark":document.body.classList.add("dark");break;case"light":document.body.classList.remove("dark");break;default:mediaQuery&&document.body.classList.add("dark");break}</script><script>var prevScrollPos=window.pageYOffset;window.addEventListener("scroll",function(){let s=document.getElementById("profileHeader"),t=window.pageYOffset,n=!1,o=!0,i=o?prevScrollPos>t:t>0;i?s.classList.add("showHeaderOnTop"):n=!0,t===0&&(n=!0),n&&s.classList.remove("showHeaderOnTop"),prevScrollPos=t})</script><header id=profileHeader><nav class="pt-3 navbar navbar-expand-lg animate"><div class="container-fluid mx-xs-2 mx-sm-5 mx-md-5 mx-lg-5"><a class="navbar-brand primary-font text-wrap" href=/><img src=/myfav.png width=30 height=30 class="d-inline-block align-top">
Chumy's Blog</a><div><input id=search autocomplete=off class="form-control mr-sm-2 d-none d-md-block" placeholder='Ctrl + k to Search...' aria-label=Search oninput=searchOnChange(event)></div><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarContent aria-controls=navbarContent aria-expanded=false aria-label="Toggle navigation"><svg aria-hidden="true" height="24" viewBox="0 0 16 16" width="24" data-view-component="true"><path fill-rule="evenodd" d="M1 2.75A.75.75.0 011.75 2h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 2.75zm0 5A.75.75.0 011.75 7h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 7.75zM1.75 12a.75.75.0 100 1.5h12.5a.75.75.0 100-1.5H1.75z"/></svg></button><div class="collapse navbar-collapse text-wrap primary-font" id=navbarContent><ul class="navbar-nav ms-auto text-center"><li class="nav-item navbar-text d-block d-md-none"><div class=nav-link><input id=search autocomplete=off class="form-control mr-sm-2" placeholder='Ctrl + k to Search...' aria-label=Search oninput=searchOnChange(event)></div></li><li class="nav-item navbar-text"><a class=nav-link href=/#about aria-label=about>About Me</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#experience aria-label=experience>Experience</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#education aria-label=education>Education</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#projects aria-label=projects>Projects</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#contact aria-label=contact>Contact</a></li><li class="nav-item navbar-text"><a class=nav-link href=/blogs title="Blog posts">Blog</a></li><li class="nav-item navbar-text"><a class=nav-link href=/cv.pdf title=CV>CV</a></li><li class="nav-item navbar-text"><div class=text-center><button id=theme-toggle><svg id="moon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></li></ul></div></div></nav></header><div id=content><section id=single><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-md-12 col-lg-9"><div class=pr-lg-4><div class="title mb-5"><h1 class="text-center mb-4">TSCCTF 2024 Official WriteUp</h1><div class=text-center>Chumy
<small>|</small>
Jan 5, 2024
<span id=readingTime>min read</span></div></div><div class=featured-image><img class="img-fluid mx-auto d-block" src=/images/CTF.png alt="TSCCTF 2024 Official WriteUp"></div><article class="page-content p-2"><h1 id=tscctf-2024-official-writeup>TSCCTF 2024 Official WriteUp</h1><p>這次與 TSC 的夥伴們一起舉辦了一場 CTF 比賽，而我則負責 infra 的建置以及出一題 reverse 題目，雖說我似乎難度沒有控好，還在學習控難度中。</p><h1 id=just-shooting-game>Just Shooting Game</h1><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/0137c941-cfd6-41f6-a329-52e6cfdff2de alt=image></p><p>基本上這題最大的難點有兩個：</p><ol><li>取得 magic 值</li><li><del>通靈出</del> Transfer.exec 是某種 bytecode interpreter ，然後把解出來的 code 丟 IDA 之類的解析。</li></ol><h2 id=解題>解題</h2><p>這題 code 用 <code>ILSpy</code> 逆會比較完整，但是這邊 writeup 還是用 Dnspy 寫。</p><p>DnSpy 打開 <code>ShootingGame_Data\Managed\Assembly-CSharp.dll</code> 會發現有一些 Class 有一個叫 <code>code</code> 的 string variable 裡面塞了一坨奇怪的東西，decode 以後會發現這些都 emoji。</p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/be16b075-60a1-42c0-8587-f80b934e9ba8 alt=image></p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/880a248f-13de-40f2-8eeb-cfc99e405ea5 alt=image></p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/3cf4e779-ceb6-428a-8a60-530322d90fd1 alt=image></p><p>這些 <code>code</code> 會在該 Class 裡和一個叫 <code>magic</code> 的變數做 <code>Transfer.etob</code> 運算以後，跟一些參數一起跑 <code>Transfer.exec</code></p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/e19af70d-a9c9-4e8e-a955-aa58db05ad20 alt=image></p><p>通過與 <code>gun</code>、<code>enemy</code> 等等 Class 比對後，發現 <code>GameManager</code> 是送入一個字串 Call <code>Transfer.exec</code> 以後會依據 Call 完後所得到的 value variable 轉成 Boolean 並判斷如果為 True 就把 <code>supermode</code> 設為 True，觀察 <code>gun</code> class 會發現 <code>supermode</code> 會讓玩家進入無敵狀態並沒有攻擊速度限制，應該是一個打入作弊代碼會開啟作弊模式的東西。其他 Call <code>Transfer.exec</code> 的地方都是在做字串比對，可以判斷 <code>Transfer.exec</code> 會依據 <code>code</code> 跟 <code>magic</code> 運算後的 byte array 做相應的事情，但是 <code>Transfer.exec</code> 到底做了甚麼還不清楚，同時因為只有 <code>GameManager</code> 不是字串比對，所以目標可能在這裡，猜測那個作弊代碼可能就是 flag。</p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/b32993fd-a56a-4923-a9a8-96d1783c6da2 alt=image></p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/9625d27f-490a-4e3f-b838-acb916a983a8 alt=image></p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/e84a351d-4f57-4f20-acf1-889c1c962849 alt=image></p><p>觀察 <code>Transfer.etob</code> 以後會發現他會將輸入的字串的做 UTF32 decode 以後依照不同的 range 減掉特定的 offset 以後跟 <code>magic</code> 做 XOR，最後減掉 128512 後強轉成 byte 然後拼回 byte array 回傳。</p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/40c38580-272d-409c-bdea-67a283cdbd8c alt=image></p><p>解析 <code>Transfer.exec</code> 可以發現他的參數變數名稱有 <code>code</code>、<code>mem</code>、<code>sp</code>、<code>bp</code> 等等疑似 memory、CPU register 的東西，但是因為他太長了要猜一下，直接整個 function 丟給 chatgpt 判斷一下，我是用 GPT4，但是 GPT 3.5 也可以，只是要分段送。</p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/c0f4cc85-2eb4-4785-858a-00edb41203a2 alt=image></p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/7009e318-4c3f-4efb-873d-239b74c0c739 alt=image></p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/5b56c4c4-4f0a-4186-8cd8-1ed36fd1d94d alt=image></p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/45ade104-80c7-4565-90c9-0481b6c32b54 alt=image></p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/e95ccc23-b8a2-4aed-91f2-cdd1efe23657 alt=image></p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/40bc55c2-fb60-4c3b-83d0-7d1dd0b50021 alt=image></p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/cfeeaf1a-1b40-48f5-b188-7eaac2cedd8c alt=image></p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/4539a256-65d0-4600-b50c-e036f5690b93 alt=image></p><p>可以確認這確實是某種 bytecode interpreter，這邊就可以知道 <code>code</code> 跟 <code>magic</code> 經過 <code>Transfer.etob</code> 以後會變成 bytecode 然後 <code>Transfer.exec</code> 再依據的命令執行 bytecode 的動作，首先我們要發 bytecode 弄出來，但是會發現我們沒有 <code>magic</code> 的值。</p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/8f36b8af-d752-4cb1-b1ed-ecb764dd30fa alt=image></p><p>寫過 unity 的話就會知道 <code>MonoBehaviour</code> 可以附加在 GameObject 上面，並且直接在 GameObject 上面指定 public variable 的值，這些在 build 完會存成 asset，所以需要找可以解析 unity asset 的工具。</p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/890b3045-7e06-49d8-a145-10ae308e3881 alt=image></p><p>用 <code>AssetRipper</code> 解開並且 export 出來，一個一個找太慢所以直接對 export 完的資料夾下 <code>grep -A 2 -B 2 -r magic .</code>，他會把資料夾下所有檔案中含有 <code>magic</code> 字串的行跟他的上下兩行印出來，為了濾出正確的，需要觀察 <code>magic</code> 的上下兩行有沒有 <code>GameManager</code> 的其他 variable ， 會發現 <code>magic: 228</code> 上有一個叫 <code>m_nextLevel</code> 的 variable，可以判斷 <code>GameManager</code> 的 <code>magic</code> 就是 228。</p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/94c57fcd-184d-4e2d-aee0-36cce9b74d05 alt=image></p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/813779f0-6fc8-4cc5-8329-fa976def9ce6 alt=image></p><p>用 python 寫 <a href=exploit/unicodetoemoji.py>unicodetoemoji.py</a> 跟 <a href=exploit/emojitobyte.py>emojitobyte.py</a> 把他解成 bytecode 並存成檔案。</p><p>接著把解出來的 bytecode 丟 Disassembler 的工具，這邊要猜一下是哪種指令集，這個 <a href=https://shell-storm.org/online/Online-Assembler-and-Disassembler>Online-Assembler-and-Disassembler</a> 網站不錯用，或者直接 IDA 用 x64 解看看，我們會拿到這坨。</p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/3f9e5b21-2d7e-416f-8efa-bd5c123e9ce0 alt=image></p><p>解析他可以得知，輸入的字串的位址在 <code>rax</code>，他會先把 <code>rax</code> 推到 stack 再來把比對目標也推到 stack，然後將輸入字串的每個字元依照特定順序做 <code>input[a] = (input[a] ^ input[b]) +- num</code>，最後將運算結果跟比對目標迴圈比對是否完全一樣，如果一樣就將 <code>rax</code> 設為 1，否則為 0。</p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/93e326bc-0541-44b9-a70e-ab3b93515583 alt=image></p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/9e709fb8-ae3b-491b-b03c-ee3929e97ecb alt=image></p><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/98b30c45-a201-4655-a8e0-e636272c9bc4 alt=image></p><p>因此只需要把運算反過來做，就可以得到 flag。</p><h2 id=exploit>exploit</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>data <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0x545C30D14737AC30</span>, <span style=color:#ae81ff>0x2B818E98088CED63</span>, <span style=color:#ae81ff>0x0BAD50580945D3F0</span>, <span style=color:#ae81ff>0x3823C33FF8E47955</span>, <span style=color:#ae81ff>0x54018BFECBE91C93</span>, <span style=color:#ae81ff>0x0F4B763093C586459</span>, <span style=color:#ae81ff>0x10E088E4C7281</span>]
</span></span><span style=display:flex><span>data <span style=color:#f92672>=</span> <span style=color:#e6db74>b</span><span style=color:#e6db74>&#39;&#39;</span><span style=color:#f92672>.</span>join([a<span style=color:#f92672>.</span>to_bytes(<span style=color:#ae81ff>8</span>, <span style=color:#e6db74>&#39;little&#39;</span>) <span style=color:#66d9ef>for</span> a <span style=color:#f92672>in</span> data])
</span></span><span style=display:flex><span>data <span style=color:#f92672>=</span> bytearray(data)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>order   <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0x2f</span>, <span style=color:#ae81ff>0x20</span>, <span style=color:#ae81ff>0x36</span>, <span style=color:#ae81ff>0x15</span>, <span style=color:#ae81ff>0x24</span>, <span style=color:#ae81ff>0x25</span>, <span style=color:#ae81ff>0x2A</span>, <span style=color:#ae81ff>0x17</span>, <span style=color:#ae81ff>0x11</span>, <span style=color:#ae81ff>0x1e</span>, <span style=color:#ae81ff>0x0c</span>, <span style=color:#ae81ff>0x32</span>, <span style=color:#ae81ff>0x07</span>, <span style=color:#ae81ff>0x04</span>, <span style=color:#ae81ff>0x33</span>, <span style=color:#ae81ff>0x27</span>, <span style=color:#ae81ff>0x09</span>, <span style=color:#ae81ff>0x02</span>, <span style=color:#ae81ff>0x08</span>, <span style=color:#ae81ff>0x22</span>, <span style=color:#ae81ff>0x0f</span>, <span style=color:#ae81ff>0x28</span>, <span style=color:#ae81ff>0x2e</span>, <span style=color:#ae81ff>0x31</span>, <span style=color:#ae81ff>0x1b</span>, <span style=color:#ae81ff>0x1f</span>, <span style=color:#ae81ff>0x1a</span>, <span style=color:#ae81ff>0x1c</span>, <span style=color:#ae81ff>0x13</span>, <span style=color:#ae81ff>0x0d</span>, <span style=color:#ae81ff>0x0e</span>, <span style=color:#ae81ff>0x30</span>, <span style=color:#ae81ff>0x1d</span>, <span style=color:#ae81ff>0x06</span>, <span style=color:#ae81ff>0x10</span>, <span style=color:#ae81ff>0x12</span>, <span style=color:#ae81ff>0x2c</span>, <span style=color:#ae81ff>0x16</span>, <span style=color:#ae81ff>0x23</span>, <span style=color:#ae81ff>0x35</span>, <span style=color:#ae81ff>0x0b</span>, <span style=color:#ae81ff>0x0a</span>, <span style=color:#ae81ff>0x2b</span>, <span style=color:#ae81ff>0x21</span>, <span style=color:#ae81ff>0x34</span>, <span style=color:#ae81ff>0x26</span>, <span style=color:#ae81ff>0x01</span>, <span style=color:#ae81ff>0x29</span>, <span style=color:#ae81ff>0x18</span>, <span style=color:#ae81ff>0x2d</span>, <span style=color:#ae81ff>0x05</span>, <span style=color:#ae81ff>0x14</span>, <span style=color:#ae81ff>0x03</span>, <span style=color:#ae81ff>0x00</span>, <span style=color:#ae81ff>0x19</span>]
</span></span><span style=display:flex><span>xorwith <span style=color:#f92672>=</span> [<span style=color:#ae81ff>0x19</span>, <span style=color:#ae81ff>0x11</span>, <span style=color:#ae81ff>0x12</span>, <span style=color:#ae81ff>0x0d</span>, <span style=color:#ae81ff>0x0e</span>, <span style=color:#ae81ff>0x1a</span>, <span style=color:#ae81ff>0x16</span>, <span style=color:#ae81ff>0x03</span>, <span style=color:#ae81ff>0x20</span>, <span style=color:#ae81ff>0x24</span>, <span style=color:#ae81ff>0x03</span>, <span style=color:#ae81ff>0x09</span>, <span style=color:#ae81ff>0x2c</span>, <span style=color:#ae81ff>0x11</span>, <span style=color:#ae81ff>0x35</span>, <span style=color:#ae81ff>0x15</span>, <span style=color:#ae81ff>0x14</span>, <span style=color:#ae81ff>0x24</span>, <span style=color:#ae81ff>0x2f</span>, <span style=color:#ae81ff>0x1e</span>, <span style=color:#ae81ff>0x05</span>, <span style=color:#ae81ff>0x2d</span>, <span style=color:#ae81ff>0x1d</span>, <span style=color:#ae81ff>0x1d</span>, <span style=color:#ae81ff>0x07</span>, <span style=color:#ae81ff>0x02</span>, <span style=color:#ae81ff>0x08</span>, <span style=color:#ae81ff>0x13</span>, <span style=color:#ae81ff>0x32</span>, <span style=color:#ae81ff>0x0b</span>, <span style=color:#ae81ff>0x14</span>, <span style=color:#ae81ff>0x02</span>, <span style=color:#ae81ff>0x2e</span>, <span style=color:#ae81ff>0x19</span>, <span style=color:#ae81ff>0x32</span>, <span style=color:#ae81ff>0x28</span>, <span style=color:#ae81ff>0x05</span>, <span style=color:#ae81ff>0x12</span>, <span style=color:#ae81ff>0x33</span>, <span style=color:#ae81ff>0x24</span>, <span style=color:#ae81ff>0x36</span>, <span style=color:#ae81ff>0x2e</span>, <span style=color:#ae81ff>0x1a</span>, <span style=color:#ae81ff>0x03</span>, <span style=color:#ae81ff>0x20</span>, <span style=color:#ae81ff>0x03</span>, <span style=color:#ae81ff>0x32</span>, <span style=color:#ae81ff>0x34</span>, <span style=color:#ae81ff>0x13</span>, <span style=color:#ae81ff>0x17</span>, <span style=color:#ae81ff>0x08</span>, <span style=color:#ae81ff>0x34</span>, <span style=color:#ae81ff>0x04</span>, <span style=color:#ae81ff>0x0c</span>, <span style=color:#ae81ff>0x32</span>]
</span></span><span style=display:flex><span>addsub  <span style=color:#f92672>=</span> [<span style=color:#f92672>-</span><span style=color:#ae81ff>0x55</span>, <span style=color:#ae81ff>0x7</span>, <span style=color:#ae81ff>0xc9</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0x81</span>, <span style=color:#ae81ff>0x29</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0x4c</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0xa1</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0x6b</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0x2d</span>, <span style=color:#ae81ff>0xe5</span>, <span style=color:#ae81ff>0x25</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0x42</span>, <span style=color:#ae81ff>0x1a</span>, <span style=color:#ae81ff>0xa4</span>, <span style=color:#ae81ff>0x50</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0xac</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0x80</span>, <span style=color:#ae81ff>0x20</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0xff</span>, <span style=color:#ae81ff>0xe5</span>, <span style=color:#ae81ff>0x25</span>, <span style=color:#ae81ff>0x2c</span>, <span style=color:#ae81ff>0x2b</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0x2a</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0x08</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0xf2</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0x29</span>, <span style=color:#ae81ff>0xdb</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0x4d</span>, <span style=color:#ae81ff>0x29</span>, <span style=color:#ae81ff>0x45</span>, <span style=color:#ae81ff>0x75</span>, <span style=color:#ae81ff>0x44</span>, <span style=color:#ae81ff>0x2d</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0x67</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0x35</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0xfc</span>, <span style=color:#ae81ff>0x6a</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0xa4</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0xa</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0x1a</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0xf0</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0xc4</span>, <span style=color:#ae81ff>0xa6</span>, <span style=color:#ae81ff>0x99</span>, <span style=color:#ae81ff>0xf2</span>, <span style=color:#ae81ff>0x7c</span>, <span style=color:#ae81ff>0xf</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0xad</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0xfb</span>, <span style=color:#ae81ff>0xf9</span>, <span style=color:#ae81ff>0xfb</span>, <span style=color:#ae81ff>0x3e</span>, <span style=color:#f92672>-</span><span style=color:#ae81ff>0x30</span>, <span style=color:#ae81ff>0x4e</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(order)):
</span></span><span style=display:flex><span>    data[order[i]] <span style=color:#f92672>=</span> (((int(data[order[i]]) <span style=color:#f92672>+</span> <span style=color:#ae81ff>256</span><span style=color:#f92672>*</span><span style=color:#ae81ff>2</span> <span style=color:#f92672>-</span> addsub[i]) <span style=color:#f92672>%</span> <span style=color:#ae81ff>256</span>) <span style=color:#f92672>^</span> (int(data[xorwith[i]])))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>data <span style=color:#f92672>=</span> bytes(data)
</span></span><span style=display:flex><span>print(data)
</span></span></code></pre></div><h2 id=flag>Flag</h2><p><img src=https://github.com/Jimmy01240397/My-CTF-Challenges/assets/57281249/80b09844-761e-44a0-8f09-cbf2444f41f9 alt=image></p><p><code>TSC{reV3R53_4md64_45m_w17H_3m0ji_1n_T3H_NeT_5oO0O_c00L}</code></p></article></div></div><div class="col-sm-12 col-md-12 col-lg-3"><div id=stickySideBar class=sticky-sidebar><aside class=toc><h5>Table Of Contents</h5><div class=toc-content><nav id=TableOfContents><ul><li><a href=#解題>解題</a></li><li><a href=#exploit>exploit</a></li><li><a href=#flag>Flag</a></li></ul></nav></div></aside><aside class=tags><h5>Tags</h5><ul class="tags-ul list-unstyled list-inline"><li class=list-inline-item><a href=https://blog.chummydns.com/tags/ctf>CTF</a></li></ul></aside><aside class=social><h5>Social</h5><div class=social-content><ul class=list-inline><li class="list-inline-item text-center"><a target=_blank href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.chummydns.com%2fblogs%2ftscctf-2024-official-writeup%2f"><i class="fab fa-linkedin"></i></a></li><li class="list-inline-item text-center"><a target=_blank href="https://twitter.com/share?text=TSCCTF%202024%20Official%20WriteUp&url=https%3a%2f%2fblog.chummydns.com%2fblogs%2ftscctf-2024-official-writeup%2f"><i class="fab fa-twitter"></i></a></li><li class="list-inline-item text-center"><a target=_blank href="https://api.whatsapp.com/send?text=TSCCTF%202024%20Official%20WriteUp: https%3a%2f%2fblog.chummydns.com%2fblogs%2ftscctf-2024-official-writeup%2f"><i class="fab fa-whatsapp"></i></a></li><li class="list-inline-item text-center"><a target=_blank href='mailto:?subject=TSCCTF%202024%20Official%20WriteUp&amp;body=Check%20out%20this%20site https%3a%2f%2fblog.chummydns.com%2fblogs%2ftscctf-2024-official-writeup%2f'><i class="fa fa-envelope"></i></a></li></ul></div></aside><img src="https://count.getloli.com/@chumyblog1910a394209a175a?darkmode=0&theme=rule34" alt=count></div></div></div><div class=row><div class="col-sm-12 col-md-12 col-lg-9 p-4"></div></div></div><button class="p-2 px-3" onclick=topFunction() id=topScroll>
<i class="fas fa-angle-up"></i></button></section><div class=progress><div id=scroll-progress-bar class=progress-bar role=progressbar aria-valuenow=0 aria-valuemin=0 aria-valuemax=100></div></div><script src=/js/scrollProgressBar.js></script><script>var topScroll=document.getElementById("topScroll");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?topScroll.style.display="block":topScroll.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}let stickySideBarElem=document.getElementById("stickySideBar"),stickyNavBar=!0;if(stickyNavBar){let e=document.getElementById("profileHeader"),t=e.offsetHeight+15;stickySideBarElem.style.top=t+"px"}else stickySideBarElem.style.top="50px"</script><script src=/js/readingTime.js></script></div><footer><div class="container py-3" id=recent-posts><div class="h3 text-center text-secondary py-3">Recent Posts</div><div class=col><div class="summary border p-3 card"><a href=https://blog.chummydns.com/blogs/downunder-ctf-2024-writeup/><div class="font-bold text-color text-xl mb-2">Downunder CTF 2024 Writeup</div><p class=text-color></p><p class="text-sm text-secondary-color items-center">July 15, 2025</p></a></div><div class="summary border p-3 card"><a href=https://blog.chummydns.com/blogs/mpls/><div class="font-bold text-color text-xl mb-2">MPLS 運作原理</div><p class=text-color></p><p class="text-sm text-secondary-color items-center">July 15, 2025</p></a></div><div class="summary border p-3 card"><a href=https://blog.chummydns.com/blogs/analysis_linux_host_by_tcp_timestamp/><div class="font-bold text-color text-xl mb-2">利用 TCP 的 Timestamps 做到精準分類來源 linux machine</div><p class=text-color></p><p class="text-sm text-secondary-color items-center">February 20, 2025</p></a></div></div></div><div class="text-center pt-2"><span class=px-1><a href=https://github.com/Jimmy01240397 aria-label=github><svg width="2.7em" height="2.7em" viewBox="0 0 1792 1792"><path id="footer-socialNetworks-github-svg-path" d="M522 1352q-8 9-20-3-13-11-4-19 8-9 20 3 12 11 4 19zm-42-61q9 12 0 19-8 6-17-7t0-18q9-7 17 6zm-61-60q-5 7-13 2-10-5-7-12 3-5 13-2 10 5 7 12zm31 34q-6 7-16-3-9-11-2-16 6-6 16 3 9 11 2 16zm129 112q-4 12-19 6-17-4-13-15t19-7q16 5 13 16zm63 5q0 11-16 11-17 2-17-11 0-11 16-11 17-2 17 11zm58-10q2 10-14 14t-18-8 14-15q16-2 18 9zm964-956v960q0 119-84.5 203.5T1376 1664h-224q-16 0-24.5-1t-19.5-5-16-14.5-5-27.5v-239q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105T1386 856q0-121-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27T578 459.5 492 446q-44 113-7 204-79 85-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-40 36-49 103-21 10-45 15t-57 5-65.5-21.5T484 1274q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 .5 103t.5 68q0 22-11 33.5t-22 13-33 1.5H416q-119 0-203.5-84.5T128 1376V416q0-119 84.5-203.5T416 128h960q119 0 203.5 84.5T1664 416z"/></svg>
</a></span><span class=px-1><a href=https://www.linkedin.com/in/%E8%81%BF%E5%96%84-%E8%94%A1-9b01b4254/ aria-label=linkedin><svg width="2.4em" height="2.4em" fill="#fff" aria-label="LinkedIn" viewBox="0 0 512 512"><rect width="512" height="512" fill="#0077b5" rx="15%"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
</a></span><a href=https://twitter.com/jimmy01240397 aria-label=twitter><svg viewBox="0 0 48 48" width="48" height="48"><path fill="#03a9f4" d="M42 37c0 2.762-2.239 5-5 5H11c-2.762.0-5-2.238-5-5V11c0-2.762 2.238-5 5-5h26c2.761.0 5 2.238 5 5V37z"/><path fill="#fff" d="M36 17.12c-.882.391-1.999.758-3 .88 1.018-.604 2.633-1.862 3-3-.951.559-2.671 1.156-3.793 1.372C31.311 15.422 30.033 15 28.617 15 25.897 15 24 17.305 24 20v2c-4 0-7.9-3.047-10.327-6-.427.721-.667 1.565-.667 2.457.0 1.819 1.671 3.665 2.994 4.543-.807-.025-2.335-.641-3-1 0 .016.0.036.0.057.0 2.367 1.661 3.974 3.912 4.422C16.501 26.592 16 27 14.072 27c.626 1.935 3.773 2.958 5.928 3-1.686 1.307-4.692 2-7 2-.399.0-.615.022-1-.023C14.178 33.357 17.22 34 20 34c9.057.0 14-6.918 14-13.37.0-.212-.007-.922-.018-1.13C34.95 18.818 35.342 18.104 36 17.12"/></svg>
</a><a href=https://www.instagram.com/rm_rf_chumy/ aria-label=instagram><svg viewBox="0 0 48 48" width="48" height="48"><radialGradient id="yOrnnhliCrdS2gy~4tD8ma" cx="19.38" cy="42.035" r="44.899" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#fd5"/><stop offset=".328" stop-color="#ff543f"/><stop offset=".348" stop-color="#fc5245"/><stop offset=".504" stop-color="#e64771"/><stop offset=".643" stop-color="#d53e91"/><stop offset=".761" stop-color="#cc39a4"/><stop offset=".841" stop-color="#c837ab"/></radialGradient><path fill="url(#yOrnnhliCrdS2gy~4tD8ma)" d="M34.017 41.99l-20 .019c-4.4.004-8.003-3.592-8.008-7.992l-.019-20c-.004-4.4 3.592-8.003 7.992-8.008l20-.019c4.4-.004 8.003 3.592 8.008 7.992l.019 20C42.014 38.383 38.417 41.986 34.017 41.99z"/><radialGradient id="yOrnnhliCrdS2gy~4tD8mb" cx="11.786" cy="5.54" r="29.813" gradientTransform="matrix(1 0 0 .6663 0 1.849)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#4168c9"/><stop offset=".999" stop-color="#4168c9" stop-opacity="0"/></radialGradient><path fill="url(#yOrnnhliCrdS2gy~4tD8mb)" d="M34.017 41.99l-20 .019c-4.4.004-8.003-3.592-8.008-7.992l-.019-20c-.004-4.4 3.592-8.003 7.992-8.008l20-.019c4.4-.004 8.003 3.592 8.008 7.992l.019 20C42.014 38.383 38.417 41.986 34.017 41.99z"/><path fill="#fff" d="M24 31c-3.859.0-7-3.14-7-7s3.141-7 7-7 7 3.14 7 7-3.141 7-7 7zm0-12c-2.757.0-5 2.243-5 5s2.243 5 5 5 5-2.243 5-5-2.243-5-5-5z"/><circle cx="31.5" cy="16.5" r="1.5" fill="#fff"/><path fill="#fff" d="M30 37H18c-3.859.0-7-3.14-7-7V18c0-3.86 3.141-7 7-7h12c3.859.0 7 3.14 7 7v12c0 3.86-3.141 7-7 7zM18 13c-2.757.0-5 2.243-5 5v12c0 2.757 2.243 5 5 5h12c2.757.0 5-2.243 5-5V18c0-2.757-2.243-5-5-5H18z"/></svg>
</a><a href="https://www.facebook.com/profile.php?id=100005111161079" aria-label=facebook><svg viewBox="0 0 48 48" width="48" height="48"><path fill="#3f51b5" d="M42 37c0 2.762-2.238 5-5 5H11c-2.761.0-5-2.238-5-5V11c0-2.762 2.239-5 5-5h26c2.762.0 5 2.238 5 5V37z"/><path fill="#fff" d="M34.368 25H31v13h-5V25h-3v-4h3v-2.41c.002-3.508 1.459-5.59 5.592-5.59H35v4h-2.287C31.104 17 31 17.6 31 18.723V21h4L34.368 25z"/></svg></a></div><div class="container py-4"><div class="row justify-content-center"><div class="col-md-4 text-center"><div class=pb-2><a href=https://blog.chummydns.com/ title="Chumy's Blog"><img alt="Footer logo" src=/myfav.png height=40px width=40px></a></div>&copy; 2025 All rights reserved<div class=text-secondary>Made with
<span class=text-danger>&#10084;
</span>and
<a href=https://github.com/gurusabarish/hugo-profile target=_blank title="Designed and developed by gurusabarish">Hugo Profile</a></div></div></div></div></footer><script src=/bootstrap-5/js/bootstrap.bundle.min.js></script><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))});var tooltipTriggerList=[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')),tooltipList=tooltipTriggerList.map(function(e){return new bootstrap.Tooltip(e)})</script><script src=/js/search.js></script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","no4s0daf78")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-L02TG541PV"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-L02TG541PV")</script><section id=search-content class=py-2><div class=container id=search-results></div></section></body></html>