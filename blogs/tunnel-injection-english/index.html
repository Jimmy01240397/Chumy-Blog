<!doctype html><html lang=en><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta http-equiv=Accept-CH content="DPR, Viewport-Width, Width"><link rel=icon href=/myfav.png type=image/gif><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" media=print onload='this.media="all"'><noscript><link href="https://fonts.googleapis.com/css2?family=Alata&family=Lora:ital,wght@0,400;0,500;0,600;0,700;1,400;1,500;1,600;1,700&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap" rel=stylesheet></noscript><link rel=stylesheet href=/css/font.css media=all><meta property="og:url" content="https://blog.chummydns.com/blogs/tunnel-injection-english/"><meta property="og:site_name" content="Chumy's Blog"><meta property="og:title" content="Free VPNs Everywhere -- Tunnel Injection"><meta property="og:description" content="Tunnel Injection Chinese
TL;DR This blog discusses the flaws of most stateless tunnel protocols and how I turned them into a free VPN that can be set up with just 5 lines of Linux ip commands.
Acknowledgments Before getting into the main topic, I’d like to thank seadog007 for STUIX, since my network’s ASN primarily peers through STUIX, and I also used a lot of their resources for testing.
Special thanks as well to NCSE for helping me by adding some IPT traffic during my testing."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="blogs"><meta property="article:published_time" content="2025-08-29T13:50:00+08:00"><meta property="article:modified_time" content="2025-08-29T13:50:00+08:00"><meta property="article:tag" content="Cyber Security"><meta property="article:tag" content="Networking"><meta name=twitter:card content="summary"><meta name=twitter:title content="Free VPNs Everywhere -- Tunnel Injection"><meta name=twitter:description content="Tunnel Injection Chinese
TL;DR This blog discusses the flaws of most stateless tunnel protocols and how I turned them into a free VPN that can be set up with just 5 lines of Linux ip commands.
Acknowledgments Before getting into the main topic, I’d like to thank seadog007 for STUIX, since my network’s ASN primarily peers through STUIX, and I also used a lot of their resources for testing.
Special thanks as well to NCSE for helping me by adding some IPT traffic during my testing."><link rel=stylesheet href=/bootstrap-5/css/bootstrap.min.css media=all><link rel=stylesheet href=/css/header.css media=all><link rel=stylesheet href=/css/footer.css media=all><link rel=stylesheet href=/css/theme.css media=all><style>:root{--text-color:#343a40;--text-secondary-color:#6c757d;--text-link-color:#007bff;--background-color:#eaedf0;--secondary-background-color:#64ffda1a;--primary-color:#007bff;--secondary-color:#f8f9fa;--text-color-dark:#e4e6eb;--text-secondary-color-dark:#b0b3b8;--text-link-color-dark:#ffffff;--background-color-dark:#18191a;--secondary-background-color-dark:#212529;--primary-color-dark:#ffffff;--secondary-color-dark:#212529}body{font-size:1rem;font-weight:400;line-height:1.5;text-align:left}html{background-color:var(--background-color)!important}body::-webkit-scrollbar{height:0;width:8px;background-color:var(--background-color)}::-webkit-scrollbar-track{border-radius:1rem}::-webkit-scrollbar-thumb{border-radius:1rem;background:#b0b0b0;outline:1px solid var(--background-color)}#search-content::-webkit-scrollbar{width:.5em;height:.1em;background-color:var(--background-color)}</style><meta name=description content><link rel=stylesheet href=/css/single.css><script defer src=/fontawesome-6/all-6.4.2.js></script><title>Free VPNs Everywhere -- Tunnel Injection | Chumy's Blog</title></head><body class=light><script>let localStorageValue=localStorage.getItem("pref-theme"),mediaQuery=window.matchMedia("(prefers-color-scheme: dark)").matches;switch(localStorageValue){case"dark":document.body.classList.add("dark");break;case"light":document.body.classList.remove("dark");break;default:mediaQuery&&document.body.classList.add("dark");break}</script><script>var prevScrollPos=window.pageYOffset;window.addEventListener("scroll",function(){let s=document.getElementById("profileHeader"),t=window.pageYOffset,n=!1,o=!0,i=o?prevScrollPos>t:t>0;i?s.classList.add("showHeaderOnTop"):n=!0,t===0&&(n=!0),n&&s.classList.remove("showHeaderOnTop"),prevScrollPos=t})</script><header id=profileHeader><nav class="pt-3 navbar navbar-expand-lg animate"><div class="container-fluid mx-xs-2 mx-sm-5 mx-md-5 mx-lg-5"><a class="navbar-brand primary-font text-wrap" href=/><img src=/myfav.png width=30 height=30 class="d-inline-block align-top">
Chumy's Blog</a><div><input id=search autocomplete=off class="form-control mr-sm-2 d-none d-md-block" placeholder='Ctrl + k to Search...' aria-label=Search oninput=searchOnChange(event)></div><button class=navbar-toggler type=button data-bs-toggle=collapse data-bs-target=#navbarContent aria-controls=navbarContent aria-expanded=false aria-label="Toggle navigation"><svg aria-hidden="true" height="24" viewBox="0 0 16 16" width="24" data-view-component="true"><path fill-rule="evenodd" d="M1 2.75A.75.75.0 011.75 2h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 2.75zm0 5A.75.75.0 011.75 7h12.5a.75.75.0 110 1.5H1.75A.75.75.0 011 7.75zM1.75 12a.75.75.0 100 1.5h12.5a.75.75.0 100-1.5H1.75z"/></svg></button><div class="collapse navbar-collapse text-wrap primary-font" id=navbarContent><ul class="navbar-nav ms-auto text-center"><li class="nav-item navbar-text d-block d-md-none"><div class=nav-link><input id=search autocomplete=off class="form-control mr-sm-2" placeholder='Ctrl + k to Search...' aria-label=Search oninput=searchOnChange(event)></div></li><li class="nav-item navbar-text"><a class=nav-link href=/#about aria-label=about>About Me</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#experience aria-label=experience>Experience</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#education aria-label=education>Education</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#projects aria-label=projects>Projects</a></li><li class="nav-item navbar-text"><a class=nav-link href=/#contact aria-label=contact>Contact</a></li><li class="nav-item navbar-text"><a class=nav-link href=/blogs title="Blog posts">Blog</a></li><li class="nav-item navbar-text"><a class=nav-link href=/cv.pdf title=CV>CV</a></li><li class="nav-item navbar-text"><div class=text-center><button id=theme-toggle><svg id="moon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></li></ul></div></div></nav></header><div id=content><section id=single><div class=container><div class="row justify-content-center"><div class="col-sm-12 col-md-12 col-lg-9"><div class=pr-lg-4><div class="title mb-5"><h1 class="text-center mb-4">Free VPNs Everywhere -- Tunnel Injection</h1><div class=text-center>Chumy
<small>|</small>
Aug 29, 2025
<span id=readingTime>min read</span></div></div><article class="page-content p-2"><h1 id=tunnel-injection>Tunnel Injection</h1><p><a href=/blogs/tunnel-injection>Chinese</a></p><h2 id=tldr>TL;DR</h2><p>This blog discusses the flaws of most stateless tunnel protocols and how I turned them into a free VPN that can be set up with just 5 lines of Linux <code>ip</code> commands.</p><h2 id=acknowledgments>Acknowledgments</h2><p>Before getting into the main topic, I’d like to thank <a href=https://seadog007.work/>seadog007</a> for <a href=https://stuix.io/>STUIX</a>, since my network’s ASN primarily peers through STUIX, and I also used a lot of their resources for testing.</p><p>Special thanks as well to <a href=https://ncse.tw/>NCSE</a> for helping me by adding some IPT traffic during my testing.</p><h2 id=introduction>Introduction</h2><p>This is a little story about how I went from researching a protocol to essentially giving the whole world access to my VPN.</p><p>Here’s how it happened: around my freshman year, I heard about this cool thing called Segment Routing v6 at a Cloud Native event. So, during my sophomore year, I started digging into it a bit and got a general understanding of its principles. As for how it actually works—since that’s not the focus of this post—I won’t go into detail here. I may publish another article on it in the future.</p><p>By junior year, I received an invitation from <a href=https://cggc.nchc.org.tw/>2024 CGGC</a> (a CTF held in Taiwan) to contribute a challenge, which got me brainstorming for ideas.</p><p><img src=https://github.com/user-attachments/assets/15d204e5-72b9-4827-97a4-9abbcb51f621 alt=image></p><p><img src=https://github.com/user-attachments/assets/21be27d8-b269-47ee-8c1b-48f3831bea3d alt=image></p><p>Then one day, while showering and replaying everything in my head, I suddenly came up with this really cool exploitation method. Fun fact: this particular challenge was only solved by <a href=https://seadog007.work/>seadog007</a>.</p><p>This is a detailed diagram of the attack method that <a href=https://seadog007.work/>seadog007</a> drew for me.</p><p><img src=https://github.com/user-attachments/assets/ac66ca21-eadc-4000-98d9-6133a3f8456d alt=image></p><h2 id=what-is-tunnel>What is Tunnel</h2><p>The tunnel most people are familiar with is the VPN, since a VPN is essentially just a type of tunnel. The core idea of a VPN is a virtual network built out of multiple encrypted or unencrypted tunnels.</p><p>Its working principle is actually quite simple—it’s basically the concept of putting an envelope inside another envelope.</p><p><img src=https://github.com/user-attachments/assets/6e5c692c-183f-41a2-a4d4-e03cb3eb4202 alt=image></p><p><img src=https://github.com/user-attachments/assets/c71b10e9-f6fa-473d-a94a-77e99d0a3dd5 alt=image></p><p>In networking terms: when a packet leaves the tunnel interface, the program handling the tunnel takes the contents of that packet, encapsulates it according to the tunnel protocol, and then sends it out via TCP, UDP, or some Layer 3 protocol payload—through either a physical NIC or another lower-layer tunnel interface.</p><p>On the receiving side, the program listening for this tunnel protocol takes incoming data from the listening port, strips off the tunnel protocol header, and delivers the inner raw data directly as a Layer 3 or Layer 2 packet to the tunnel interface.</p><p><img src=https://github.com/user-attachments/assets/88cf1d26-7f70-485e-8089-6e39ec9e4bca alt=image></p><p>A stateless tunnel protocol simply means: whenever it receives a packet in that protocol format, it just decapsulates and forwards it—without performing any kind of verification or handshake.</p><h2 id=impact>Impact</h2><p>So what happens if there’s no verification? Basically, as long as I can forge a packet that matches the tunnel protocol format, I can inject malicious packets through this unprotected tunnel and deliver them into the victim’s internal network.</p><p>However, past research has generally considered this kind of attack to be one-way—at most enabling DDoS attacks.</p><p><img src=https://github.com/user-attachments/assets/9c57dd15-5db7-438b-9d39-d7871cd189aa alt=image></p><p><img src=https://github.com/user-attachments/assets/21321374-4940-4520-9e9a-618ce5ccb06e alt=image></p><p>Including a paper published just this January: <a href=https://www.top10vpn.com/research/tunneling-protocol-vulnerability/>research</a></p><p><img src=https://github.com/user-attachments/assets/359e4baa-1152-4fe7-9445-976b6a74733b alt=image></p><p>That study covered many scanning methods for exposed stateless tunnels, as well as issues with certain router models not verifying source IPs. But its main focus was still on DDoS attack surfaces.</p><p>In reality, you only need to shift your perspective a little: we don’t actually need traffic to flow back and forth through the tunnel.</p><p>The real essence of the attack is simply being able to inject traffic into the tunnel. That’s why I’ve decided to call it Tunnel Injection.</p><h3 id=tunnel-injection-to-internal-network>Tunnel Injection to Internal Network</h3><p>The first exploitation method allows us to achieve Interactive Internal Network Access.</p><p>We begin by crafting a forged packet that conforms to the tunnel protocol.</p><ul><li><p>The outer layer:</p><ul><li><p>Source IP = attacker’s public IP (or in some tunnel protocols, since source IP verification is performed, this might require IP spoofing).</p></li><li><p>Destination IP = victim tunnel’s public IP.</p></li></ul></li><li><p>The inner layer:</p><ul><li><p>Source IP = <font color=red>attacker’s public IP</font> ← this is the core idea here.</p></li><li><p>Destination IP = <font color=red>the private IP of the victim’s internal machine</font> you want to target.</p></li></ul></li></ul><p><img src=https://github.com/user-attachments/assets/7a95b8c2-cf6c-4d50-9439-1a7ff17d9f52 alt=image></p><p>So what happens once we send it out?</p><p>When the packet reaches the victim’s router, it gets decapsulated. The router then forwards the inner packet according to its routing table, while leaving behind a conntrack entry for the forwarding record.</p><p><img src=https://github.com/user-attachments/assets/d0e5e518-0435-42b3-96c1-5529311bfd73 alt=image></p><p>The internal machine will then see a packet with:</p><p>src = <font color=red>public IP</font>, dst = victim’s internal machine&rsquo;s IP</p><p>Naturally, it replies with:</p><p>src = victim’s internal machine’s IP, dst = <font color=red>public IP</font></p><p><img src=https://github.com/user-attachments/assets/33f5e5d2-2954-457b-bae5-e43ba2b12040 alt=image></p><p>When this reply reaches the victim’s router, because the destination is the public IP, it simply gets forwarded out via the default gateway.</p><p>One important note: most routers won’t SNAT “odd” packet types like TCP SYN/ACK or ICMP Echo Reply (pong). So when these reply packets leave the victim’s router, they are not NATed. In such cases, the source IP remains the private IP, which may cause issues in certain scenarios.</p><p>Finally, the attacker receives these responses from the victim’s internal network.</p><p><img src=https://github.com/user-attachments/assets/2a483ec0-2a7d-445a-a8cb-403f24bcd8bc alt=image></p><p>This enables Arbitrary Interactive Internal Network Access.</p><iframe width=560 height=315 src="https://www.youtube.com/embed/KSNkpPdzw8o?si=pE8cLkI-OTlZILsh" title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy=strict-origin-when-cross-origin allowfullscreen></iframe><h3 id=tunnel-injection-to-external-network>Tunnel Injection to External Network</h3><p>Before explaining the attack, let’s first look at how NAT is usually implemented—using Linux as an example.</p><p>On a Linux kernel–based router, NAT is handled with netfilter and conntrack. The common user-facing tools are iptables and nftables. Here we’ll take iptables as an example.</p><p>Normally, to enable NAT, you might use:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>iptables -t nat -A POSTROUTING -o wan -s 192.168.0.0/16 -j MASQUERADE
</span></span></code></pre></div><p>This rule means: when a packet leaves the <font color=red>wan</font> interface, if its source IP matches 192.168.0.0/16, then perform NAT using the wan interface’s public IP as the new source IP.</p><p>But in reality, many router vendors take a shortcut and simply write:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>iptables -t nat -A POSTROUTING -o wan -j MASQUERADE
</span></span></code></pre></div><p>This means: whenever a packet leaves the <font color=red>wan</font> interface, NAT it with the wan interface’s public IP as the source.</p><p>Notice what’s missing—the source IP check. That means if the source IP is already a public IP, it still gets NATed. After all, <a href=https://datatracker.ietf.org/doc/html/rfc1918>RFC 1918</a> is just a definition; nothing stops you from using a public IP as if it were private.</p><p>Now, what happens if this router is also running an exposed tunnel?</p><p>The answer: we get a free proxy jump point.</p><p>In practice, all we need to do is modify the inner destination IP from the <a href=#tunnel-injection-to-internal-network>Tunnel Injection to Internal Network</a> example—this time setting it to the target public IP on the external network.</p><p>Again, we forge a tunnel protocol–compliant packet:</p><ul><li><p>The outer layer:</p><ul><li><p>Source IP = attacker’s public IP (or spoofed).</p></li><li><p>Destination IP = victim tunnel’s public IP.</p></li></ul></li><li><p>The inner layer:</p><ul><li><p>Source IP = <font color=red>attacker’s public IP</font></p></li><li><p>Destination IP = <font color=red>the target public IP you want to access</font>.</p></li></ul></li></ul><p><img src=https://github.com/user-attachments/assets/ffbfa772-3f79-4701-ad49-b968441ba406 alt=image></p><p>When the packet arrives at the victim’s router, it gets decapsulated, forwarded according to the routing table, NATed according to the <code>iptables</code> rule above, and logged into conntrack as a NAT entry.</p><p><img src=https://github.com/user-attachments/assets/b120f257-d8b2-4392-a619-80133643455c alt=image></p><p>The target then receives the packet and replies. Since NAT has already rewritten the source IP, the target sees:</p><ul><li>src = <font color=red>victim public IP</font>, dst = <font color=red>target public ip</font></li></ul><p>So its response is:</p><ul><li>src = <font color=red>target public ip</font>, dst = <font color=red>victim public IP</font></li></ul><p><img src=https://github.com/user-attachments/assets/92a6f6f4-293e-42ff-80be-e659a6bd32cd alt=image></p><p>When the victim’s router receives the response, conntrack restores the original destination IP and forwards it according to its routing table.</p><p><img src=https://github.com/user-attachments/assets/9ab444c2-9e01-4723-996e-e006786c340c alt=image></p><p>And now the attacker receives the response.</p><p><img src=https://github.com/user-attachments/assets/9c24ec6f-6eae-4fe0-a7fd-df7588e38fd2 alt=image></p><p>This enables an Arbitrary Interactive Pivoting Attack via Tunnel.</p><p><img src=https://github.com/user-attachments/assets/6dfa50fa-0f75-46f5-acf2-b4d52f2a313c alt=image></p><iframe width=560 height=315 src="https://www.youtube.com/embed/EC9qySzo6J4?si=mF9rBsuFrUwao2-k" title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy=strict-origin-when-cross-origin allowfullscreen></iframe><h2 id=rpf-or-source-ip-verify-bypass>RPF or source ip verify bypass</h2><p>Just when you think you’re done, reality often hits you in the face.</p><p>Remember what we mentioned earlier in <a href=#tunnel-injection-to-internal-network>Tunnel Injection to Internal Network</a>:</p><pre tabindex=0><code>Most routers don’t perform SNAT on unusual packet types like TCP SYN/ACK or ICMP type 0 (pong).  
So when the response packet leaves the victim router, it won’t be NATed—meaning the source IP remains private.  
This can be problematic in certain scenarios.
</code></pre><p>And that “scenario” refers to Reverse Path Forwarding (RPF) or source IP verification.</p><p><img src=https://github.com/user-attachments/assets/e80bb09f-a306-4308-944b-938e24e01da0 alt=image></p><p>Most ISPs, in order to prevent customers from launching IP spoofing attacks, will enable RPF on client-facing interfaces.</p><p>RPF works like this: when an interface receives a packet, it checks the source IP against the routing table. If the source IP doesn’t match any route that should arrive via that interface, the packet is dropped.</p><p>So if the victim’s ISP enforces this protection, you won’t receive a response.
How do we bypass this?</p><h3 id=bypass-for-internal-network-access>Bypass for Internal Network Access</h3><p>Let’s take a look at how P2P networks implement NAT hole punching.</p><p>If both sides already know (or can predict) each other’s source ports—in the case of P2P applications, a STUN server usually helps clients discover their NATed source ports—then both sides can simultaneously send a packet to the other’s public IP and port. Let’s use UDP as an example.</p><p><img src=https://github.com/user-attachments/assets/590fc3b4-e990-4ebb-8f8d-e44c20f9f30f alt=image></p><p>As the packets traverse the routers, NAT is applied and the conntrack table records a NAT mapping entry.</p><p><img src=https://github.com/user-attachments/assets/1a9e7d65-5fc1-44c0-bbed-92361eaed76d alt=image></p><p>Both packets reach each other’s routers, where conntrack already has a matching NAT entry.</p><p><img src=https://github.com/user-attachments/assets/4e531fdf-9045-44aa-bb86-2b1b7189c7e2 alt=image></p><p>Thus, the destination IP is restored based on conntrack records.</p><p><img src=https://github.com/user-attachments/assets/368274e7-f142-4270-becf-f3589dfd908a alt=image></p><p>That’s the basic flow of NAT hole punching. With TCP it’s more complex since TCP is stateful—look up TCP Simultaneous Open for details. In fact, HITCON CTF 2025 even had a <a href=https://ctf2025.hitcon.org/dashboard/#19>challenge</a> based on this, since TCP Self-Connect is essentially a special case of TCP Simultaneous Open.</p><p>By the way, I only fully understood the details of P2P transmission because back in high school I <a href=https://github.com/Jimmy01240397/NetworkServicePackage>hand-coded the entire NAT hole punching process and even built my own STUN server</a> (though looking back, the code is a bit ugly). Some people ask why reinvent the wheel, but I believe building it yourself is both fun and the best way to learn.</p><p>So we can think of NAT hole punching as a restricted form of port forwarding triggered from the inside.</p><p>Now—since Tunnel Injection allows us to inject packets from the inside out, could we manually perform NAT hole punching and then directly access the internal network from the outside?</p><p>Yes, we can. Let’s use TCP as an example.</p><p>We use Tunnel Injection to send a TCP SYN from within the victim’s internal network to perform hole punching.</p><ul><li>Source IP = victim internal machine’s <font color=red>private IP</font></li><li>Destination IP = attacker’s <font color=red>public IP</font></li></ul><p><img src=https://github.com/user-attachments/assets/34fa43d2-f10d-4c30-bf6b-9bba2537b88d alt=image></p><p>The packet reaches the victim router, gets forwarded, NATed, and logged in conntrack.</p><p>Hole punched!</p><p><img src=https://github.com/user-attachments/assets/68ca12ef-176c-42c8-9306-406007a1eaa2 alt=image></p><p>Now we send a TCP SYN toward that hole:</p><ul><li>Source IP = <font color=red>attacker’s public IP</font></li><li>Destination IP = <font color=red>victim internal machine’s private IP</font></li></ul><p><img src=https://github.com/user-attachments/assets/6a05f51d-89e9-4b54-a0d8-a1af4b66f30e alt=image></p><p>The router restores the destination IP via conntrack and forwards it to the victim’s internal machine.</p><p><img src=https://github.com/user-attachments/assets/9da739d2-8185-4c74-a558-1268905a25b5 alt=image></p><p>The victim machine responds with TCP SYN/ACK.</p><p><img src=https://github.com/user-attachments/assets/dd125103-65b5-4ff8-a28d-106f12453ba6 alt=image></p><p>And the source IP is NATed normally to the victim’s public IP.</p><p><img src=https://github.com/user-attachments/assets/dfc538ec-f8bd-4f92-ad21-d53ad41c4f77 alt=image></p><p>The attacker replies with ACK.</p><p><img src=https://github.com/user-attachments/assets/a2f3b7a5-61fd-45f8-a810-3076ed283495 alt=image></p><p>Now the connection is established, and the attacker can interactively communicate with the internal network.</p><p><img src=https://github.com/user-attachments/assets/30dec908-b538-4163-8151-7adc197584d2 alt=image></p><p>However, this process only works reliably for UDP.</p><p>For TCP, it only works on some routers or older Linux kernels. Modern Linux kernels perform strict conntrack validation of TCP Simultaneous Open. If one side never receives the SYN/ACK, the state machine remains stuck at SYN_SENT2. In this case, even if the internal host sends a TCP PUSH, <font color=red>it will not be NATed to the victim’s public IP</font>.</p><p>Since the attacker’s SYN/ACK never reaches the victim’s internal host, the connection never transitions to ESTABLISHED.</p><p>Could we solve this by manually sending the attacker’s SYN/ACK to the victim’s host?</p><p>Not really—because conntrack tears down the record whenever a TCP RST is seen, and most systems will respond to an unknown SYN/ACK with an immediate RST. (After all, the victim host never initiated the SYN, so it doesn’t recognize this session.)</p><p>While this trick may work in some networks where RST packets are dropped, we should assume the default case: it will fail.</p><p>So how to fix?</p><p>Looking at sysctl parameters, we find that conntrack’s TCP close state timeout is only 10 seconds. After that, the record is freed.</p><p><img src=https://github.com/user-attachments/assets/fcab59ab-27a7-4a7f-a1e5-10c82ae13728 alt=image></p><p>Another interesting parameter is <code>net.netfilter.nf_conntrack_tcp_loose</code></p><p><img src=https://github.com/user-attachments/assets/84632096-8e77-4e61-bb89-35a1617bfbc3 alt=image></p><p>By default, this is set to 1.</p><p>What does it mean?</p><p>When <code>nf_conntrack_tcp_loose = 1</code>, conntrack allows NAT to be applied to stray TCP PUSH or ACK packets even if no matching session exists. In other words, when there is no active conntrack entry, an outbound TCP PUSH or ACK can create a new NAT entry in the ESTABLISHED state.</p><p>This opens up an opportunity: because the close-state timeout is short and TCP retransmits unacknowledged packets, we can:</p><ol><li>Use Tunnel Injection to send a TCP RST from inside, freeing the conntrack record.</li><li>Wait for the victim host to retransmit its TCP PUSH.</li><li>Conntrack treats this retransmit as a new session, installs an ESTABLISHED NAT entry, and the attacker can now communicate interactively.</li></ol><p>So here is the full flow recap</p><p>Use Tunnel Injection to send a TCP SYN from inside the victim’s network:</p><ul><li>Source IP = <font color=red>victim’s private IP</font></li><li>Destination IP = <font color=red>attacker’s public IP</font></li></ul><p><img src=https://github.com/user-attachments/assets/34fa43d2-f10d-4c30-bf6b-9bba2537b88d alt=image></p><p>The packet reaches the victim router, gets forwarded, NATed, and logged in conntrack.</p><p><img src=https://github.com/user-attachments/assets/68ca12ef-176c-42c8-9306-406007a1eaa2 alt=image></p><p>Now we send a TCP SYN toward that hole:</p><ul><li>Source IP = <font color=red>attacker’s public IP</font></li><li>Destination IP = <font color=red>victim internal machine’s private IP</font></li></ul><p><img src=https://github.com/user-attachments/assets/6a05f51d-89e9-4b54-a0d8-a1af4b66f30e alt=image></p><p>The router restores the destination IP via conntrack and forwards it to the victim’s internal machine.</p><p><img src=https://github.com/user-attachments/assets/9da739d2-8185-4c74-a558-1268905a25b5 alt=image></p><p>The victim machine responds with TCP SYN/ACK.</p><p><img src=https://github.com/user-attachments/assets/dd125103-65b5-4ff8-a28d-106f12453ba6 alt=image></p><p>And the source IP is NATed normally to the victim’s public IP.</p><p><img src=https://github.com/user-attachments/assets/dfc538ec-f8bd-4f92-ad21-d53ad41c4f77 alt=image></p><p>The attacker replies with ACK.</p><p><img src=https://github.com/user-attachments/assets/a2f3b7a5-61fd-45f8-a810-3076ed283495 alt=image></p><p>Attacker sends a PUSH (e.g., HTTP request).</p><p><img src=https://github.com/user-attachments/assets/3f55be71-accc-4b0e-8aa1-878ac136cc92 alt=image></p><p>Initially dropped. Victim retransmits repeatedly.</p><p><img src=https://github.com/user-attachments/assets/ef676fa9-b7d5-492b-86bd-ffd606b8c0bb alt=image></p><p>Because of the mechanism explained above, the PUSH packet from the internal host is dropped. The attacker doesn’t receive it, doesn’t ACK it, and the internal host keeps retransmitting.</p><p><img src=https://github.com/user-attachments/assets/ef676fa9-b7d5-492b-86bd-ffd606b8c0bb alt=image></p><p>We then use Tunnel Injection to send a TCP RST from inside, manually freeing the conntrack record.</p><p><img src=https://github.com/user-attachments/assets/7671e6c4-8041-4034-b9da-93fd323e0b1d alt=image></p><p>After freeing it, when the internal host retransmits the TCP PUSH</p><p><img src=https://github.com/user-attachments/assets/115257d7-8133-4b60-9dd9-3177cbb7583d alt=image></p><p>It will be successfully NATed, and conntrack will log a new NAT record in the <font color=red>ESTABLISHED state</font>.</p><p><img src=https://github.com/user-attachments/assets/b04c2350-c5b4-428f-b55d-7f665be6a19e alt=image></p><p>Now the connection is fully established, and we can happily send data into the internal network.</p><p><img src=https://github.com/user-attachments/assets/30dec908-b538-4163-8151-7adc197584d2 alt=image></p><p>With this, we have successfully achieved RPF bypass for Internal Network Access.</p><iframe width=560 height=315 src="https://www.youtube.com/embed/1YkltH1gCz4?si=V0iYDhGsGvKnd70O" title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy=strict-origin-when-cross-origin allowfullscreen></iframe><h3 id=bypass-for-external-network-access>Bypass for External Network Access</h3><p>The previous section was simpler because the entire bypass process only required a single NAT operation. However, for External Network Access, bypassing requires performing two NAT translations:</p><ol><li>Changing the outbound packet’s source IP to the victim’s public IP</li><li>Changing the return packet’s source IP to the victim’s public IP</li></ol><p>So, how do we achieve this?</p><p>If the victim’s internal network has another layer of tunnel combined with NAT, we can <font color=red>build a NAT Chain.</font>.</p><p><img src=https://github.com/user-attachments/assets/6e0361aa-f2ed-48ba-8bfa-b97eae5e9a5a alt=image></p><p>We use Tunnel Injection to send a TCP SYN from the victim’s first-layer internal network to perform hole punching.</p><ul><li>Source IP = <font color=red>target’s public IP</font></li><li>Destination IP = <font color=red>attacker’s public IP</font></li></ul><p><img src=https://github.com/user-attachments/assets/eccd387e-42e7-44eb-8962-faa95ec0ffb2 alt=image></p><p>When the packet arrives at the victim’s first-layer router, it is forwarded according to the router’s routing table, NAT source IP translation is applied, and a conntrack entry is created.</p><p><img src=https://github.com/user-attachments/assets/9a6223c9-c748-41be-81c2-9ae450bdc4e7 alt=image></p><p>We then send a TCP SYN so that the first-layer router’s conntrack record transitions into the SYN_SENT2 state.</p><p><img src=https://github.com/user-attachments/assets/674aa743-e4b6-4bad-b05b-ea7763fb6f79 alt=image></p><p>This packet is dropped by RPF when forwarded to the target.</p><p><img src=https://github.com/user-attachments/assets/e8b0399a-96c1-4b5a-98be-a9f29b356cba alt=image></p><p>Next, we use Tunnel Injection from the victim’s second-layer internal network to send a TCP SYN to the target.</p><ul><li>Source IP = <font color=red>attacker’s public IP</font></li><li>Destination IP = <font color=red>target’s public IP</font></li></ul><p><img src=https://github.com/user-attachments/assets/59105cb3-cdd6-4808-b561-499c8b839fcf alt=image></p><p><img src=https://github.com/user-attachments/assets/0689a0c6-40e9-4ee9-b5f2-43aa9fed3f1a alt=image></p><p>The TCP SYN is NATed by the second-layer router, and a conntrack entry is created.</p><p><img src=https://github.com/user-attachments/assets/00729446-faa7-401c-b282-030aae85a543 alt=image></p><p>It is then NATed again by the first-layer router, and a conntrack entry is created.</p><p><img src=https://github.com/user-attachments/assets/7be48293-0ae1-4f67-b4c1-bad4cae8c9d0 alt=image></p><p>The target responds with SYN/ACK, and the destination IP is restored according to conntrack.</p><p><img src=https://github.com/user-attachments/assets/61f1d773-6e80-4f93-a80f-eec9a253db2e alt=image></p><p>The destination IP becomes the WAN IP of the second-layer router, which forwards it, restoring the destination IP according to its conntrack record.</p><p><img src=https://github.com/user-attachments/assets/0b813ca9-8604-48ad-9eb9-8f18c31d0416 alt=image></p><p>The destination IP then becomes the attacker’s public IP and is sent to the first-layer router.</p><p><img src=https://github.com/user-attachments/assets/a84a2fcb-a332-4680-8f34-2d07c5cfc5b3 alt=image></p><p>Here’s the interesting part: the source IP is the target’s public IP, which matches the NAT record that was previously created in the first-layer router.</p><p>So the source IP is NATed again according to conntrack.</p><p><img src=https://github.com/user-attachments/assets/48ecb285-68ef-4a9f-82aa-030b7e9d910a alt=image></p><p>The attacker finally receives a packet with the source IP rewritten to the <font color=red>victim’s first-layer router’s public IP</font>.</p><p><img src=https://github.com/user-attachments/assets/511aede6-4882-4676-a2a8-2204684283d7 alt=image></p><p>From here, the process is the same as described earlier in <a href=#bypass-for-internal-network-access>Bypass for Internal Network Access</a>.</p><p>ACK is returned.</p><p><img src=https://github.com/user-attachments/assets/ac76ca3c-6eae-40fb-9aba-fa0a0864c138 alt=image></p><p>PUSH is sent.</p><p><img src=https://github.com/user-attachments/assets/32ab2ce8-6caa-482a-add0-144899e0d438 alt=image></p><p>RST is sent to free the conntrack record.</p><p><img src=https://github.com/user-attachments/assets/5f543174-edbe-4aa2-8aef-bf269000150d alt=image></p><p>The target continues retransmitting.</p><p><img src=https://github.com/user-attachments/assets/94a00362-e077-46f6-8c43-0cc7cda68ab3 alt=image></p><p>It is successfully NATed, and conntrack now records an ESTABLISHED entry.</p><p><img src=https://github.com/user-attachments/assets/6c0dbb36-6cf7-4b89-b55d-56acf98acaa6 alt=image></p><p>Thus, we have successfully achieved RPF bypass for External Network Access.</p><iframe width=560 height=315 src="https://www.youtube.com/embed/_GcIFKyjGmE?si=qWA0cVCgFotki8nm" title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy=strict-origin-when-cross-origin allowfullscreen></iframe><p>Moreover, the use of a NAT Chain is not limited to bypassing RPF. It can also be used during Internal Network Access to bypass server-side source checks, since some servers also enforce their own firewall rules.</p><h2 id=l2-tunnel-abuse>L2 Tunnel Abuse</h2><p>Earlier, we mainly talked about exploiting L3 tunnels. L2 tunnels are a bit more troublesome because they require an additional Ethernet header. This means we need the router’s or an internal machine’s MAC address to make use of them—or alternatively, we can attempt to exploit broadcast or multicast.</p><p>So, can we use broadcast or multicast to leak useful information such as MAC addresses?</p><p>Yes, it’s possible.</p><p>When an internal network not only uses IPv4 but also enables IPv6 with unicast addresses, ICMPv6 requests are allowed to be multicast by default. This means we can use multicast IPv6 ping to leak IPv6 addresses.</p><p><img src=https://github.com/user-attachments/assets/abc2edae-bf6e-46f9-ae66-001080bdffb2 alt=image></p><p>First, we craft a multicast ping inside the victim’s internal network, using a multicast MAC address and the attacker’s public IPv6 address.</p><p><img src=https://github.com/user-attachments/assets/ea7fd3e3-1d59-403d-a125-cbc0243b043e alt=image></p><p>The switch will multicast this ping to all devices subscribed to that multicast MAC address.</p><p><img src=https://github.com/user-attachments/assets/5465ba53-bc01-486a-806f-8472c1c52097 alt=image></p><p>The internal victim devices will then reply with ICMP pong messages back to the attacker.</p><p><img src=https://github.com/user-attachments/assets/950c89a1-933d-4d69-a962-b042104c807c alt=image></p><p>As a result, we can obtain all IPv6 addresses of devices in the internal network.</p><p><img src=https://github.com/user-attachments/assets/4ed1c850-90c0-4e26-824f-82a9a49e0f22 alt=image></p><iframe width=560 height=315 src="https://www.youtube.com/embed/Eqb1dv2bPzk?si=gX9q73c6ubSatqVy" title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy=strict-origin-when-cross-origin allowfullscreen></iframe><p>Now, what can we do with these IPv6 addresses?</p><p>According to <a href=https://datatracker.ietf.org/doc/html/rfc4291>RFC 4291</a>, one method of dynamically generating SLAAC IPv6 addresses is based on the host’s MAC address.</p><p><img src=https://github.com/user-attachments/assets/39dad163-bb73-420f-bced-ca58c684cb1c alt=image></p><p>An IPv6 address generated in this way can be reversed back into the original MAC address. By default, Linux uses this method to generate IPv6 addresses.</p><p><img src=https://github.com/user-attachments/assets/9e120a86-764d-4558-992c-07732265b8e0 alt=image></p><p>In addition, another researcher from Trend Micro, <a href=https://github.com/123ojp>123ojp</a>, has also been researching this type of attack vector. He discovered even more efficient exploitation methods specifically targeting VXLAN, an L2 tunnel protocol. If you are interested, check out his talk at <a href=https://defcon.org/html/defcon-33/dc-33-speakers.html#content_60316>DEFCON 33</a>.</p><h2 id=ipsec>IPSec</h2><p>Some may assume that simply enabling IPSec is enough to protect against these kinds of attacks. However, in reality, if your IPSec is misconfigured, you can still be vulnerable—even with IPSec enabled.</p><p>In theory, once IPSec is enabled, all packets of the specified protocol should be intercepted by xfrm before leaving the NIC, encrypted, and then transmitted. Likewise, any raw packets of the specified protocol entering the NIC should be dropped.</p><p>However, xfrm has a special parameter called level. This parameter allows outbound traffic to be encrypted while still permitting raw inbound packets. Although this setting is not enabled by default, you never know what your IT team might do after struggling all day to configure IPSec without success—they might flip something they shouldn’t out of frustration.</p><p><img src=https://github.com/user-attachments/assets/58e4082d-c02c-4299-a859-05bf197ea631 alt=image></p><iframe width=560 height=315 src="https://www.youtube.com/embed/y1ZlsGSu-RY?si=9klBHYJLEvnkw1aR" title="YouTube video player" frameborder=0 allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy=strict-origin-when-cross-origin allowfullscreen></iframe><p>As a side note: on EdgeOS, even when the level attribute is set to its default value require, raw packets may still be allowed. This was discovered by my friend <a href=https://zenwen.tw/>zen</a>, the current network administrator of <a href=https://www.ccns.io/>NCKU CCNS</a>. However, this finding is still pending further confirmation.</p><h2 id=scanning-and-real-world>Scanning and Real World</h2><p>Finally, let’s talk about scanning.</p><p>Although <a href=https://www.top10vpn.com/research/tunneling-protocol-vulnerability/>this research</a> has already described concrete scanning methods, I’ll share my own approach here.</p><h3 id=internal-access-able>Internal access able</h3><p>We can test this by injecting an ICMP Echo Request into the victim’s tunnel, originating from inside the victim’s internal network:</p><ul><li>Source IP = private IP</li><li>Destination IP = scanner’s IP</li></ul><p>In the ICMP ping payload, we include some marker information along with the tunnel’s outer source IP and destination IP.</p><p>If we later receive the exact same ICMP ping on the WAN side, we can confirm that the victim’s router has an exposed tunnel for that protocol.</p><p>Then, by checking whether the source IP of the received packet is rewritten to a public IP, we can determine whether the victim router performs NAT.</p><p><img src=https://github.com/user-attachments/assets/5cf3582e-5570-4f27-aa24-9fa9d02f16b4 alt=image></p><p><img src=https://github.com/user-attachments/assets/e3347bbf-949f-4682-aca2-051b501daa9d alt=image></p><p><img src=https://github.com/user-attachments/assets/10ca7e2d-3a10-493e-92f3-8574b1fa36e8 alt=image></p><p>Next, to check for RPF (Reverse Path Forwarding), we can inject an ICMP Echo Reply (pong) through the victim’s tunnel:</p><ul><li>Source IP = private IP</li><li>Destination IP = scanner’s IP</li></ul><p>As mentioned earlier in <a href=#tunnel-injection-to-internal-network>Tunnel Injection to Internal Network</a>, &ldquo;Routers generally do not SNAT unusual packets such as TCP SYN/ACK or ICMP type 0 (pong).&rdquo;</p><p>Therefore, packets leaving the victim router will definitely have a private source IP.</p><p>By simply checking whether the scanner receives the reply, we can tell whether the victim’s ISP enforces RPF.</p><p><img src=https://github.com/user-attachments/assets/6f3f4e5e-dee9-4929-9a93-edfb430a7fe2 alt=image></p><p><img src=https://github.com/user-attachments/assets/b4ba60ec-3f38-4086-979d-af123ce393e3 alt=image></p><h3 id=external-access-able>External access able</h3><p>Since the set of externally accessible tunnels is necessarily a subset of the internally accessible tunnels with NAT, we can take that filtered IP list and scan it again.</p><p>The setup is the same, but this time we add a controlled target host.</p><p>We inject an ICMP Echo Request into the victim’s tunnel from its internal network:</p><ul><li>Source IP = scanner’s IP</li><li>Destination IP = target host’s IP</li></ul><p><img src=https://github.com/user-attachments/assets/11f911c5-5654-4810-a88a-9a79596a6c3b alt=image></p><p>If the tunnel is externally accessible, the victim router should NAT the source IP to its public IP and forward the packet to the target. The target must be configured to log all incoming packets.</p><p><img src=https://github.com/user-attachments/assets/14d6f543-e252-49c7-ac93-ed754cd525ec alt=image></p><p>The target will reply with an ICMP Echo Reply, which returns to the victim router.</p><p><img src=https://github.com/user-attachments/assets/aed43a57-e31d-4eda-bde2-7c56ba9c588b alt=image></p><p>The victim router restores the destination IP and sends the packet back to the scanner.</p><p>At this point, by comparing the scanner logs with the target logs, we can determine exactly which tunnels are externally accessible.</p><p><img src=https://github.com/user-attachments/assets/dda1ce57-eae0-46a9-88bc-31241d4de968 alt=image></p><h3 id=scan-results>Scan Results</h3><p>Here are the results of scanning tunnels that do not require IP spoofing:</p><p>In total:</p><ul><li>GRE: 230,035 hosts<ul><li>With NAT enabled: 191,961 hosts<ul><li>Externally accessible: 22,875 hosts</li></ul></li></ul></li><li>IPIP: 76,209 hosts<ul><li>With NAT enabled: 23,851 hosts<ul><li>Externally accessible: 5,438 hosts</li></ul></li></ul></li></ul><p>Since some ISPs assign dynamic IPs, there may be slight inaccuracies in these numbers.</p><p>We also analyzed the ASNs of these IPs. As expected, a large portion belonged to Chinese IP ranges.</p><p>GRE:</p><p><img src=https://github.com/user-attachments/assets/efb0aa63-43e5-45a5-bf00-0dbd50c8e38a alt=image></p><p>IPIP:</p><p><img src=https://github.com/user-attachments/assets/a69480e1-7fdc-4045-9b6d-f33a749b5151 alt=image></p><h2 id=conclusion>Conclusion</h2><p>In the end, it was a bit unfortunate — because <a href=https://github.com/123ojp>123ojp</a> happened to be working on the same research slightly earlier, I didn’t end up submitting this work to <a href=https://hitcon.org/2025/zh-TW/>HITCON 2025</a>.</p><p>That said, I still managed to present it as a HITCON Lightning Talk, where I shared this interesting finding and also introduced the <a href=#tunnel-injection-to-external-network>Tunnel Injection To External Network</a> technique that <a href=https://github.com/123ojp>123ojp</a> hadn’t mentioned or considered. In the end, it turned into a fun and engaging discussion.</p><p>Going forward, I might try to submit this research to other security conferences.</p><p>As a side note: although all of the demos above were implemented with custom hand-written tools, in theory — if you don’t need to perform <a href=#rpf-or-source-ip-verify-bypass>RPF Bypass</a> — the same internal and external attacks can actually be executed with just <font color=red>five lines of Linux ip commands</font>. I’ll leave that as homework for you all. XXD</p></article></div></div><div class="col-sm-12 col-md-12 col-lg-3"><div id=stickySideBar class=sticky-sidebar><aside class=toc><h5>Table Of Contents</h5><div class=toc-content><nav id=TableOfContents><ul><li><a href=#tldr>TL;DR</a></li><li><a href=#acknowledgments>Acknowledgments</a></li><li><a href=#introduction>Introduction</a></li><li><a href=#what-is-tunnel>What is Tunnel</a></li><li><a href=#impact>Impact</a><ul><li><a href=#tunnel-injection-to-internal-network>Tunnel Injection to Internal Network</a></li><li><a href=#tunnel-injection-to-external-network>Tunnel Injection to External Network</a></li></ul></li><li><a href=#rpf-or-source-ip-verify-bypass>RPF or source ip verify bypass</a><ul><li><a href=#bypass-for-internal-network-access>Bypass for Internal Network Access</a></li><li><a href=#bypass-for-external-network-access>Bypass for External Network Access</a></li></ul></li><li><a href=#l2-tunnel-abuse>L2 Tunnel Abuse</a></li><li><a href=#ipsec>IPSec</a></li><li><a href=#scanning-and-real-world>Scanning and Real World</a><ul><li><a href=#internal-access-able>Internal access able</a></li><li><a href=#external-access-able>External access able</a></li><li><a href=#scan-results>Scan Results</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></aside><aside class=tags><h5>Tags</h5><ul class="tags-ul list-unstyled list-inline"><li class=list-inline-item><a href=https://blog.chummydns.com/tags/cyber-security>Cyber Security</a></li><li class=list-inline-item><a href=https://blog.chummydns.com/tags/networking>Networking</a></li></ul></aside><aside class=social><h5>Social</h5><div class=social-content><ul class=list-inline><li class="list-inline-item text-center"><a target=_blank href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fblog.chummydns.com%2fblogs%2ftunnel-injection-english%2f"><i class="fab fa-linkedin"></i></a></li><li class="list-inline-item text-center"><a target=_blank href="https://twitter.com/share?text=Free%20VPNs%20Everywhere%20--%20Tunnel%20Injection&url=https%3a%2f%2fblog.chummydns.com%2fblogs%2ftunnel-injection-english%2f"><i class="fab fa-twitter"></i></a></li><li class="list-inline-item text-center"><a target=_blank href="https://api.whatsapp.com/send?text=Free%20VPNs%20Everywhere%20--%20Tunnel%20Injection: https%3a%2f%2fblog.chummydns.com%2fblogs%2ftunnel-injection-english%2f"><i class="fab fa-whatsapp"></i></a></li><li class="list-inline-item text-center"><a target=_blank href='mailto:?subject=Free%20VPNs%20Everywhere%20--%20Tunnel%20Injection&amp;body=Check%20out%20this%20site https%3a%2f%2fblog.chummydns.com%2fblogs%2ftunnel-injection-english%2f'><i class="fa fa-envelope"></i></a></li></ul></div></aside><img src="https://count.getloli.com/@chumyblog9fdfc36762b96f03?darkmode=0&theme=rule34" alt=count></div></div></div><div class=row><div class="col-sm-12 col-md-12 col-lg-9 p-4"></div></div></div><button class="p-2 px-3" onclick=topFunction() id=topScroll>
<i class="fas fa-angle-up"></i></button></section><div class=progress><div id=scroll-progress-bar class=progress-bar role=progressbar aria-valuenow=0 aria-valuemin=0 aria-valuemax=100></div></div><script src=/js/scrollProgressBar.js></script><script>var topScroll=document.getElementById("topScroll");window.onscroll=function(){scrollFunction()};function scrollFunction(){document.body.scrollTop>20||document.documentElement.scrollTop>20?topScroll.style.display="block":topScroll.style.display="none"}function topFunction(){document.body.scrollTop=0,document.documentElement.scrollTop=0}let stickySideBarElem=document.getElementById("stickySideBar"),stickyNavBar=!0;if(stickyNavBar){let e=document.getElementById("profileHeader"),t=e.offsetHeight+15;stickySideBarElem.style.top=t+"px"}else stickySideBarElem.style.top="50px"</script><script src=/js/readingTime.js></script></div><footer><div class="container py-3" id=recent-posts><div class="h3 text-center text-secondary py-3">Recent Posts</div><div class=col><div class="summary border p-3 card"><a href=https://blog.chummydns.com/blogs/tunnel-injection-english/><div class="font-bold text-color text-xl mb-2">Free VPNs Everywhere -- Tunnel Injection</div><p class=text-color></p><p class="text-sm text-secondary-color items-center">August 29, 2025</p></a></div><div class="summary border p-3 card"><a href=https://blog.chummydns.com/blogs/tunnel-injection/><div class="font-bold text-color text-xl mb-2">到處都有免費 VPN -- Tunnel Injection</div><p class=text-color></p><p class="text-sm text-secondary-color items-center">August 28, 2025</p></a></div><div class="summary border p-3 card"><a href=https://blog.chummydns.com/blogs/hitconctf-2025-qual/><div class="font-bold text-color text-xl mb-2">HITCON CTF 2025 Qual Writeup</div><p class=text-color></p><p class="text-sm text-secondary-color items-center">August 25, 2025</p></a></div></div></div><div class="text-center pt-2"><span class=px-1><a href=https://github.com/Jimmy01240397 aria-label=github><svg width="2.7em" height="2.7em" viewBox="0 0 1792 1792"><path id="footer-socialNetworks-github-svg-path" d="M522 1352q-8 9-20-3-13-11-4-19 8-9 20 3 12 11 4 19zm-42-61q9 12 0 19-8 6-17-7t0-18q9-7 17 6zm-61-60q-5 7-13 2-10-5-7-12 3-5 13-2 10 5 7 12zm31 34q-6 7-16-3-9-11-2-16 6-6 16 3 9 11 2 16zm129 112q-4 12-19 6-17-4-13-15t19-7q16 5 13 16zm63 5q0 11-16 11-17 2-17-11 0-11 16-11 17-2 17 11zm58-10q2 10-14 14t-18-8 14-15q16-2 18 9zm964-956v960q0 119-84.5 203.5T1376 1664h-224q-16 0-24.5-1t-19.5-5-16-14.5-5-27.5v-239q0-97-52-142 57-6 102.5-18t94-39 81-66.5 53-105T1386 856q0-121-79-206 37-91-8-204-28-9-81 11t-92 44l-38 24q-93-26-192-26t-192 26q-16-11-42.5-27T578 459.5 492 446q-44 113-7 204-79 85-79 206 0 85 20.5 150t52.5 105 80.5 67 94 39 102.5 18q-40 36-49 103-21 10-45 15t-57 5-65.5-21.5T484 1274q-19-32-48.5-52t-49.5-24l-20-3q-21 0-29 4.5t-5 11.5 9 14 13 12l7 5q22 10 43.5 38t31.5 51l10 23q13 38 44 61.5t67 30 69.5 7 55.5-3.5l23-4q0 38 .5 103t.5 68q0 22-11 33.5t-22 13-33 1.5H416q-119 0-203.5-84.5T128 1376V416q0-119 84.5-203.5T416 128h960q119 0 203.5 84.5T1664 416z"/></svg>
</a></span><span class=px-1><a href=https://www.linkedin.com/in/%E8%81%BF%E5%96%84-%E8%94%A1-9b01b4254/ aria-label=linkedin><svg width="2.4em" height="2.4em" fill="#fff" aria-label="LinkedIn" viewBox="0 0 512 512"><rect width="512" height="512" fill="#0077b5" rx="15%"/><circle cx="142" cy="138" r="37"/><path stroke="#fff" stroke-width="66" d="M244 194v198M142 194v198"/><path d="M276 282c0-20 13-40 36-40 24 0 33 18 33 45v105h66V279c0-61-32-89-76-89-34 0-51 19-59 32"/></svg>
</a></span><a href=https://twitter.com/jimmy01240397 aria-label=twitter><svg viewBox="0 0 48 48" width="48" height="48"><path fill="#03a9f4" d="M42 37c0 2.762-2.239 5-5 5H11c-2.762.0-5-2.238-5-5V11c0-2.762 2.238-5 5-5h26c2.761.0 5 2.238 5 5V37z"/><path fill="#fff" d="M36 17.12c-.882.391-1.999.758-3 .88 1.018-.604 2.633-1.862 3-3-.951.559-2.671 1.156-3.793 1.372C31.311 15.422 30.033 15 28.617 15 25.897 15 24 17.305 24 20v2c-4 0-7.9-3.047-10.327-6-.427.721-.667 1.565-.667 2.457.0 1.819 1.671 3.665 2.994 4.543-.807-.025-2.335-.641-3-1 0 .016.0.036.0.057.0 2.367 1.661 3.974 3.912 4.422C16.501 26.592 16 27 14.072 27c.626 1.935 3.773 2.958 5.928 3-1.686 1.307-4.692 2-7 2-.399.0-.615.022-1-.023C14.178 33.357 17.22 34 20 34c9.057.0 14-6.918 14-13.37.0-.212-.007-.922-.018-1.13C34.95 18.818 35.342 18.104 36 17.12"/></svg>
</a><a href=https://www.instagram.com/rm_rf_chumy/ aria-label=instagram><svg viewBox="0 0 48 48" width="48" height="48"><radialGradient id="yOrnnhliCrdS2gy~4tD8ma" cx="19.38" cy="42.035" r="44.899" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#fd5"/><stop offset=".328" stop-color="#ff543f"/><stop offset=".348" stop-color="#fc5245"/><stop offset=".504" stop-color="#e64771"/><stop offset=".643" stop-color="#d53e91"/><stop offset=".761" stop-color="#cc39a4"/><stop offset=".841" stop-color="#c837ab"/></radialGradient><path fill="url(#yOrnnhliCrdS2gy~4tD8ma)" d="M34.017 41.99l-20 .019c-4.4.004-8.003-3.592-8.008-7.992l-.019-20c-.004-4.4 3.592-8.003 7.992-8.008l20-.019c4.4-.004 8.003 3.592 8.008 7.992l.019 20C42.014 38.383 38.417 41.986 34.017 41.99z"/><radialGradient id="yOrnnhliCrdS2gy~4tD8mb" cx="11.786" cy="5.54" r="29.813" gradientTransform="matrix(1 0 0 .6663 0 1.849)" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#4168c9"/><stop offset=".999" stop-color="#4168c9" stop-opacity="0"/></radialGradient><path fill="url(#yOrnnhliCrdS2gy~4tD8mb)" d="M34.017 41.99l-20 .019c-4.4.004-8.003-3.592-8.008-7.992l-.019-20c-.004-4.4 3.592-8.003 7.992-8.008l20-.019c4.4-.004 8.003 3.592 8.008 7.992l.019 20C42.014 38.383 38.417 41.986 34.017 41.99z"/><path fill="#fff" d="M24 31c-3.859.0-7-3.14-7-7s3.141-7 7-7 7 3.14 7 7-3.141 7-7 7zm0-12c-2.757.0-5 2.243-5 5s2.243 5 5 5 5-2.243 5-5-2.243-5-5-5z"/><circle cx="31.5" cy="16.5" r="1.5" fill="#fff"/><path fill="#fff" d="M30 37H18c-3.859.0-7-3.14-7-7V18c0-3.86 3.141-7 7-7h12c3.859.0 7 3.14 7 7v12c0 3.86-3.141 7-7 7zM18 13c-2.757.0-5 2.243-5 5v12c0 2.757 2.243 5 5 5h12c2.757.0 5-2.243 5-5V18c0-2.757-2.243-5-5-5H18z"/></svg>
</a><a href="https://www.facebook.com/profile.php?id=100005111161079" aria-label=facebook><svg viewBox="0 0 48 48" width="48" height="48"><path fill="#3f51b5" d="M42 37c0 2.762-2.238 5-5 5H11c-2.761.0-5-2.238-5-5V11c0-2.762 2.239-5 5-5h26c2.762.0 5 2.238 5 5V37z"/><path fill="#fff" d="M34.368 25H31v13h-5V25h-3v-4h3v-2.41c.002-3.508 1.459-5.59 5.592-5.59H35v4h-2.287C31.104 17 31 17.6 31 18.723V21h4L34.368 25z"/></svg></a></div><div class="container py-4"><div class="row justify-content-center"><div class="col-md-4 text-center"><div class=pb-2><a href=https://blog.chummydns.com/ title="Chumy's Blog"><img alt="Footer logo" src=/myfav.png height=40px width=40px></a></div>&copy; 2025 All rights reserved<div class=text-secondary>Made with
<span class=text-danger>&#10084;
</span>and
<a href=https://github.com/gurusabarish/hugo-profile target=_blank title="Designed and developed by gurusabarish">Hugo Profile</a></div></div></div></div></footer><script src=/bootstrap-5/js/bootstrap.bundle.min.js></script><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))});var tooltipTriggerList=[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')),tooltipList=tooltipTriggerList.map(function(e){return new bootstrap.Tooltip(e)})</script><script src=/js/search.js></script><script type=text/javascript>(function(e,t,n,s,o,i,a){e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},i=t.createElement(s),i.async=1,i.src="https://www.clarity.ms/tag/"+o,a=t.getElementsByTagName(s)[0],a.parentNode.insertBefore(i,a)})(window,document,"clarity","script","no4s0daf78")</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-L02TG541PV"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-L02TG541PV")</script><section id=search-content class=py-2><div class=container id=search-results></div></section></body></html>