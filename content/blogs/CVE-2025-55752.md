---
title: "CVE-2025-55752 Tomcat path traversal to WEB-INF（中文）"
date: 2025-11-10T00:00:00+08:00
draft: false
github_link: ""
author: "Chumy"
tags:
  - Cyber Security
  - Research
image: ""
description: ""
toc: 
---

# CVE-2025-55752

## 前言

之前看到 [CTF 戰隊](https://nckuctf.org/)好隊友 [Vincent](http://vincent55.tw/) 挖 Apache Airflow 的漏洞挖得很開心，我就想說我也要挖一個開源專案的洞，所以就有這一篇了。

## 歷史 CVE

首先我們來看看 Tomcat 近期有趣的 CVE 有哪些：

| CVE | description |   
|--------|---|
| [CVE-2024-50379](https://lists.apache.org/thread/y6lj6q1xnp822g6ro70tn19sgtjmr80r) | If PUT enable, TOCTOU file upload jsp to RCE |
| [CVE-2024-56337](https://lists.apache.org/thread/b2b9qrgjrz1kvo4ym8y2wkfdvwoq6qbp) | If PUT enable, TOCTOU file upload jsp to RCE |
| [CVE-2025-24813](https://lists.apache.org/thread/j5fkjv2k477os90nczf2v9l61fb0kkgq) | If PUT enable, File Upload to session java deserialize |
| [CVE-2025-31651](https://lists.apache.org/thread/cpklvqwvdrp4k9hmd2l3q33j0gzy4fox) | Rewrite rule Confusion Attacks |

可以發現多數可能造成 RCE 的 CVE 都假設 PUT enable 的情況，但是如果有 PUT 直接上傳 jsp webshell 不就好了嗎？

這是因為 Tomcat 的 PUT 實際上主要是說 DefaultServlet 的 PUT。

當 Tomcat 收到 HTTP request 時，首先會先 Parse HTTP request 然後依照 web.xml 裡面的 servlet 規則決定這個 request 要送給哪一個 servlet 處理，而預設情況下 jsp 與 jspx 會被轉給 JspServlet

![image](https://github.com/user-attachments/assets/391402f6-5237-4adb-97b4-ba9ec77ba554)

也正因為如此我們永遠無法用 PUT upload jsp webshell 上去，除非有 0 day，比如 CVE-2024-56337、CVE-2024-56339 就是利用了某些 OS 無視大小寫的特性，並且 TOCTOU 繞過 Tomcat 內部的 symbol link check 來達成 PUT upload jsp webshell。

## Tomcat 運作流程



