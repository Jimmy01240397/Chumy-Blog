<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Networking on Chumy's Blog</title><link>https://hugo-profile.netlify.app/tags/networking/</link><description>Recent content in Networking on Chumy's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sat, 08 Apr 2023 00:00:00 +0800</lastBuildDate><atom:link href="https://hugo-profile.netlify.app/tags/networking/index.xml" rel="self" type="application/rss+xml"/><item><title>從 Wireshark 到 patch OpenVPN driver</title><link>https://hugo-profile.netlify.app/blogs/openvpn-patch/</link><pubDate>Sat, 08 Apr 2023 00:00:00 +0800</pubDate><guid>https://hugo-profile.netlify.app/blogs/openvpn-patch/</guid><description>緣由 當初會這樣是因為接到一個很有趣的 case
簡單來說就是想要 client 可以打 VPN 到另一邊，並且讓 PPPoE 可以透過 VPN 拿到中華電信的 public IP address。
由於 PPPoE 是 L2 的協定，需要 ethernet header，因此 VPN 的選擇上就需要用 L2 Tunnel。關於甚麼是 L2 Tunnel 可以去看這篇文章與這篇文章。
這邊我選擇用 OpenVPN tap 作為 L2 Tunnel。
過程 於是乎我開始架設 VPN 架設的 config 可以參考這裡。
架好的我開開心心的用 windows 測試
到這邊我想說拿到 IP 了應該能動了，結果 ping 一下發現出不去。
這就很奇怪了，於是乎我 ping 看看 ipv6 看看是不是一樣的問題，結果可以通。
這下有趣了，V4 沒通 V6 有通，怎麼想都不正常，再加上我兩個都有拿到 IP。
而作為一個遇到問題會死命 debug 的我直接就開始抓包測試。
可以發現 ICMP ping 確實有封裝上 PPPoE header 並且從 VPN 網卡送出，且 VPN server 是有收到並轉發出去的，但是遲遲沒收到 response，因此可能是上游因為某些原因，可能不認可我們持有的 V4 IP 然後 drop 掉，但是認可 V6 的 IP。</description></item></channel></rss>